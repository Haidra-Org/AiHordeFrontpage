import{a as O,b as R}from"./chunk-DY5J6W22.js";import{a as z}from"./chunk-ISHBUXAM.js";import{c as N}from"./chunk-BMIYH3UD.js";import{a as G}from"./chunk-VFTR325L.js";import{f as $,k as Z}from"./chunk-XFTKCJLM.js";import{k as D}from"./chunk-GZDNXZTC.js";import{Cb as h,Db as u,F as Q,Oa as t,Ob as C,Rb as l,Sb as m,Tb as x,X as I,Za as U,aa as M,ba as g,ca as k,da as w,ga as q,gc as c,hc as p,ic as V,ja as b,nc as y,ob as _,pb as v,r as P,rb as H,sb as A,tb as E,ub as n,vb as a,wb as f,zb as F}from"./chunk-QF4LG6ZD.js";import"./chunk-4CLCTAJ7.js";var W=(i,s)=>s.name;function J(i,s){i&1&&f(0,"div",7)}function K(i,s){i&1&&(k(),n(0,"svg",3),f(1,"path",12),a())}function X(i,s){if(i&1&&(n(0,"div",8)(1,"div",13)(2,"span",14),l(3),c(4,"transloco"),a(),n(5,"span",15),l(6),a()(),n(7,"div",13)(8,"span",14),l(9),c(10,"transloco"),a(),n(11,"span",15),l(12),n(13,"span",16),l(14," ("),f(15,"app-unit-tooltip",17),l(16,") "),a()()()()),i&2){let o=u();t(3),m(p(4,6,"details.models.total_models")),t(3),m(o.formatNumber(o.currentModels().length)),t(3),m(p(10,8,"details.models.total_queued")),t(3),x(" ",o.totalQueuedUnit().primary.formatted," "),t(3),E("unit",o.totalQueuedUnit())("swapDisplay",!0)}}function Y(i,s){if(i&1&&(n(0,"span",25),l(1),a()),i&2){let o=u(2);t(),m(o.sortDirection()==="asc"?"\u2191":"\u2193")}}function ee(i,s){if(i&1&&(n(0,"span",25),l(1),a()),i&2){let o=u(2);t(),m(o.sortDirection()==="asc"?"\u2191":"\u2193")}}function te(i,s){if(i&1&&(n(0,"span",25),l(1),a()),i&2){let o=u(2);t(),m(o.sortDirection()==="asc"?"\u2191":"\u2193")}}function ie(i,s){if(i&1&&(n(0,"span",25),l(1),a()),i&2){let o=u(2);t(),m(o.sortDirection()==="asc"?"\u2191":"\u2193")}}function ne(i,s){if(i&1&&(n(0,"span",25),l(1),a()),i&2){let o=u(2);t(),m(o.sortDirection()==="asc"?"\u2191":"\u2193")}}function oe(i,s){if(i&1){let o=F();n(0,"div",9)(1,"div",18),k(),n(2,"svg",19),f(3,"path",20),a(),w(),n(4,"input",21),c(5,"transloco"),h("input",function(r){M(o);let d=u();return g(d.onSearchChange(r))}),a()(),n(6,"div",22)(7,"span",23),l(8),c(9,"transloco"),a(),n(10,"button",24),h("click",function(){M(o);let r=u();return g(r.setSortField("name"))}),l(11),c(12,"transloco"),_(13,Y,2,1,"span",25),a(),n(14,"button",24),h("click",function(){M(o);let r=u();return g(r.setSortField("count"))}),l(15),c(16,"transloco"),_(17,ee,2,1,"span",25),a(),n(18,"button",24),h("click",function(){M(o);let r=u();return g(r.setSortField("queued"))}),l(19),c(20,"transloco"),_(21,te,2,1,"span",25),a(),n(22,"button",24),h("click",function(){M(o);let r=u();return g(r.setSortField("jobs"))}),l(23),c(24,"transloco"),_(25,ie,2,1,"span",25),a(),n(26,"button",24),h("click",function(){M(o);let r=u();return g(r.setSortField("eta"))}),l(27),c(28,"transloco"),_(29,ne,2,1,"span",25),a()()()}if(i&2){let o=u();t(4),E("placeholder",p(5,23,"details.models.search_placeholder"))("value",o.searchQuery()),t(4),m(p(9,25,"details.models.sort_by")),t(2),C("sort-active",o.sortField()==="name"),t(),x(" ",p(12,27,"details.models.sort.name")," "),t(2),v(o.sortField()==="name"?13:-1),t(),C("sort-active",o.sortField()==="count"),t(),x(" ",p(16,29,"details.models.sort.workers")," "),t(2),v(o.sortField()==="count"?17:-1),t(),C("sort-active",o.sortField()==="queued"),t(),x(" ",p(20,31,"details.models.sort.queued")," "),t(2),v(o.sortField()==="queued"?21:-1),t(),C("sort-active",o.sortField()==="jobs"),t(),x(" ",p(24,33,"details.models.sort.jobs")," "),t(2),v(o.sortField()==="jobs"?25:-1),t(),C("sort-active",o.sortField()==="eta"),t(),x(" ",p(28,35,"details.models.sort.eta")," "),t(2),v(o.sortField()==="eta"?29:-1)}}function ae(i,s){if(i&1){let o=F();n(0,"div",10),k(),n(1,"svg",26),f(2,"path",27),a(),w(),n(3,"p"),l(4),a(),n(5,"button",28),h("click",function(){M(o);let r=u();return g(r.loadModels())}),l(6),c(7,"transloco"),a()()}if(i&2){let o=u();t(4),m(o.error()),t(2),x(" ",p(7,2,"details.models.retry")," ")}}function le(i,s){i&1&&(n(0,"div",11),f(1,"div",29),n(2,"p"),l(3),c(4,"transloco"),a()()),i&2&&(t(3),m(p(4,1,"details.models.loading")))}function re(i,s){i&1&&(n(0,"p"),l(1),c(2,"transloco"),a()),i&2&&(t(),m(p(2,1,"details.models.no_results")))}function se(i,s){i&1&&(n(0,"p"),l(1),c(2,"transloco"),a()),i&2&&(t(),m(p(2,1,"details.models.no_models")))}function de(i,s){if(i&1&&(n(0,"div",30),k(),n(1,"svg",32),f(2,"path",33),a(),_(3,re,3,3,"p")(4,se,3,3,"p"),a()),i&2){let o=u(2);t(3),v(o.searchQuery()?3:4)}}function ce(i,s){if(i&1&&(l(0),c(1,"number"),f(2,"app-unit-tooltip",43)),i&2){let o=u().$implicit,e=u(3);x(" ",V(1,3,e.getModelQueuedUnit(o).primary.value,"1.1-1")," "),t(2),E("unit",e.getModelQueuedUnit(o))("primaryOverride",e.activeTab()==="image"?"mps":"tokens")}}function pe(i,s){i&1&&l(0," - ")}function me(i,s){if(i&1&&(l(0),c(1,"number"),f(2,"app-unit-tooltip",43)),i&2){let o=s,e=u(4);x(" ",V(1,3,o.primary.value,"1.2-2")," "),t(2),E("unit",o)("primaryOverride",e.activeTab()==="image"?"mps/sec":"tokens/sec")}}function ue(i,s){i&1&&l(0," - ")}function _e(i,s){if(i&1&&(n(0,"div",37)(1,"div",38)(2,"span",39),l(3),a()(),n(4,"div",40)(5,"span",41),l(6),c(7,"transloco"),a(),n(8,"span",42),l(9),a()(),n(10,"div",40)(11,"span",41),l(12),c(13,"transloco"),a(),n(14,"span",42),_(15,ce,3,6)(16,pe,1,0),a()(),n(17,"div",40)(18,"span",41),l(19),c(20,"transloco"),a(),n(21,"span",42),l(22),a()(),n(23,"div",40)(24,"span",41),l(25),c(26,"transloco"),a(),n(27,"span",42),l(28),a()(),n(29,"div",40)(30,"span",41),l(31),c(32,"transloco"),a(),n(33,"span",42),_(34,me,3,6)(35,ue,1,0),a()()()),i&2){let o,e=s.$implicit,r=u(3);t(2),E("title",e.name),t(),m(e.name),t(3),m(p(7,24,"details.models.workers")),t(2),C("models-table-value-highlight",e.count>10)("models-table-value-muted",e.count===0),t(),x(" ",r.formatNumber(e.count)," "),t(3),m(p(13,26,"details.models.queued")),t(2),C("models-table-value-muted",e.queued===0),t(),v(e.queued&&e.queued>0?15:16),t(4),m(p(20,28,"details.models.jobs")),t(2),C("models-table-value-muted",e.jobs===0),t(),x(" ",r.formatNumber(e.jobs)," "),t(3),m(p(26,30,"details.models.eta")),t(2),C("models-table-value-muted",!e.eta||e.eta<=0),t(),x(" ",r.formatEta(e.eta)," "),t(3),m(p(32,32,"details.models.performance")),t(2),C("models-table-value-muted",!e.performance||e.performance<=0),t(),v((o=r.getModelPerformanceUnit(e))?34:35,o)}}function ve(i,s){if(i&1&&(n(0,"div",31)(1,"div",34)(2,"span",35),l(3),c(4,"transloco"),a(),n(5,"span",36),l(6),c(7,"transloco"),a(),n(8,"span",36),l(9),c(10,"transloco"),a(),n(11,"span",36),l(12),c(13,"transloco"),a(),n(14,"span",36),l(15),c(16,"transloco"),a(),n(17,"span",36),l(18),c(19,"transloco"),a()(),H(20,_e,36,34,"div",37,W),a()),i&2){let o=u(2);t(3),m(p(4,6,"details.models.sort.name")),t(3),m(p(7,8,"details.models.workers")),t(3),m(p(10,10,"details.models.queued")),t(3),m(p(13,12,"details.models.jobs")),t(3),m(p(16,14,"details.models.eta")),t(3),m(p(19,16,"details.models.performance")),t(2),A(o.filteredModels())}}function xe(i,s){if(i&1&&_(0,de,5,1,"div",30)(1,ve,22,18,"div",31),i&2){let o=u();v(o.filteredModels().length===0?0:1)}}var Be=(()=>{let s=class s{constructor(){this.title=I(Z),this.translator=I(z),this.aiHorde=I(G),this.destroyRef=I(q),this.unitConversion=I(R),this.activeTab=b("image"),this.loading=b(!1),this.error=b(null),this.imageModels=b([]),this.textModels=b([]),this.searchQuery=b(""),this.sortField=b("count"),this.sortDirection=b("desc"),this.currentModels=y(()=>this.activeTab()==="image"?this.imageModels():this.textModels()),this.filteredModels=y(()=>{let e=this.currentModels(),r=this.searchQuery().toLowerCase().trim(),d=this.sortField(),B=this.sortDirection(),j=e;return r&&(j=e.filter(S=>S.name.toLowerCase().includes(r))),[...j].sort((S,L)=>{let T=0;return d==="name"?T=S.name.localeCompare(L.name):d==="count"?T=(S.count??0)-(L.count??0):d==="queued"?T=(S.queued??0)-(L.queued??0):d==="jobs"?T=(S.jobs??0)-(L.jobs??0):d==="eta"&&(T=(S.eta??0)-(L.eta??0)),B==="asc"?T:-T})}),this.totalWorkers=y(()=>this.currentModels().reduce((e,r)=>e+(r.count??0),0)),this.totalQueued=y(()=>this.currentModels().reduce((e,r)=>e+(r.queued??0),0)),this.totalQueuedUnit=y(()=>{let e=this.totalQueued();return this.activeTab()==="image"?this.unitConversion.formatModelQueuedImage(e):this.unitConversion.formatModelQueuedText(e)})}getModelQueuedUnit(e){return this.activeTab()==="image"?this.unitConversion.formatModelQueuedImage(e.queued??0):this.unitConversion.formatModelQueuedText(e.queued??0)}getModelPerformanceUnit(e){return!e.performance||e.performance<=0?null:this.activeTab()==="image"?this.unitConversion.formatModelPerformanceImage(e.performance):this.unitConversion.formatModelPerformanceText(e.performance)}ngOnInit(){P([this.translator.get("details.models.title"),this.translator.get("app_title")]).pipe(D(this.destroyRef)).subscribe(([e,r])=>{this.title.setTitle(`${e} | ${r}`)}),this.loadModels()}setActiveTab(e){this.activeTab()!==e&&(this.activeTab.set(e),this.searchQuery.set(""),e==="image"&&this.imageModels().length===0?this.loadModels():e==="text"&&this.textModels().length===0&&this.loadModels())}loadModels(){let e=this.activeTab();this.loading.set(!0),this.error.set(null),(e==="image"?this.aiHorde.getImageModels():this.aiHorde.getTextModels()).pipe(D(this.destroyRef),Q(()=>this.loading.set(!1))).subscribe({next:d=>{e==="image"?this.imageModels.set(d):this.textModels.set(d)},error:d=>{this.error.set(d.message||(e==="image"?"Failed to load image models":"Failed to load text models"))}})}onSearchChange(e){let r=e.target;this.searchQuery.set(r.value)}setSortField(e){this.sortField()===e?this.sortDirection.set(this.sortDirection()==="asc"?"desc":"asc"):(this.sortField.set(e),this.sortDirection.set("desc"))}formatEta(e){return!e||e<=0?"-":e<60?`${Math.round(e)}s`:e<3600?`${Math.round(e/60)}m`:`${Math.round(e/3600)}h`}formatNumber(e){return e==null?"-":e.toLocaleString()}};s.\u0275fac=function(r){return new(r||s)},s.\u0275cmp=U({type:s,selectors:[["app-models-list"]],decls:22,vars:20,consts:[[1,"stack-lg"],[1,"details-tabs"],["type","button",1,"details-tab",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24","aria-hidden","true",1,"icon-sm"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M7.5 8.25h9m-9 3H12m-9.75 1.51c0 1.6 1.123 2.994 2.707 3.227 1.129.166 2.27.293 3.423.379.35.026.67.21.865.501L12 21l2.755-4.133a1.14 1.14 0 0 1 .865-.501 48.172 48.172 0 0 0 3.423-.379c1.584-.233 2.707-1.626 2.707-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0 0 12 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018Z"],["type","button",1,"btn-source-control",3,"click","disabled"],["aria-hidden","true",1,"spinner","spinner-sm"],[1,"details-summary"],[1,"details-filters"],[1,"state-container","state-container-sm","state-error"],[1,"state-container","state-container-sm","text-secondary"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"],[1,"summary-stat"],[1,"summary-label"],[1,"summary-value"],[1,"text-secondary"],[3,"unit","swapDisplay"],[1,"filter-search"],["fill","none","stroke","currentColor","viewBox","0 0 24 24","aria-hidden","true",1,"icon-sm","filter-search-icon"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"],["type","text",1,"filter-input",3,"input","placeholder","value"],[1,"filter-sort"],[1,"filter-label"],["type","button",1,"sort-button",3,"click"],[1,"sort-indicator"],["fill","none","stroke","currentColor","viewBox","0 0 24 24","aria-hidden","true",1,"state-icon"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 9v3.75m9-.75a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 3.75h.008v.008H12v-.008Z"],["type","button",1,"btn-source-control",3,"click"],[1,"spinner","spinner-md"],[1,"state-container","state-container-sm","state-muted"],[1,"models-table"],["fill","none","stroke","currentColor","viewBox","0 0 24 24","aria-hidden","true",1,"state-icon-lg"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","1.5","d","M9.75 3.104v5.714a2.25 2.25 0 0 1-.659 1.591L5 14.5M9.75 3.104c-.251.023-.501.05-.75.082m.75-.082a24.301 24.301 0 0 1 4.5 0m0 0v5.714c0 .597.237 1.17.659 1.591L19.8 15.3M14.25 3.104c.251.023.501.05.75.082M19.8 15.3l-1.57.393A9.065 9.065 0 0 1 12 15a9.065 9.065 0 0 1-6.23.693L5 15.3m14.8 0 .002.004A4.5 4.5 0 0 1 17.25 21h-10.5a4.5 4.5 0 0 1-2.553-5.696l.002-.004"],[1,"models-table-header"],[1,"models-table-th"],[1,"models-table-th","models-table-th-right"],[1,"models-table-row"],[1,"models-table-cell-name"],[1,"models-table-name",3,"title"],[1,"models-table-cell"],[1,"models-table-label"],[1,"models-table-value"],[3,"unit","primaryOverride"]],template:function(r,d){r&1&&(n(0,"div",0)(1,"div",1)(2,"button",2),h("click",function(){return d.setActiveTab("image")}),k(),n(3,"svg",3),f(4,"path",4),a(),l(5),c(6,"transloco"),a(),w(),n(7,"button",2),h("click",function(){return d.setActiveTab("text")}),k(),n(8,"svg",3),f(9,"path",5),a(),l(10),c(11,"transloco"),a(),w(),n(12,"button",6),h("click",function(){return d.loadModels()}),_(13,J,1,0,"div",7)(14,K,2,0,":svg:svg",3),l(15),c(16,"transloco"),a()(),_(17,X,17,10,"div",8),_(18,oe,30,37,"div",9),_(19,ae,8,4,"div",10),_(20,le,5,3,"div",11),_(21,xe,2,1),a()),r&2&&(t(2),C("details-tab-active",d.activeTab()==="image"),t(3),x(" ",p(6,14,"details.models.tabs.image")," "),t(2),C("details-tab-active",d.activeTab()==="text"),t(3),x(" ",p(11,16,"details.models.tabs.text")," "),t(2),E("disabled",d.loading()),t(),v(d.loading()?13:14),t(2),x(" ",p(16,18,"details.models.refresh")," "),t(2),v(!d.loading()&&!d.error()&&d.currentModels().length>0?17:-1),t(),v(!d.loading()&&!d.error()&&d.currentModels().length>0?18:-1),t(),v(d.error()?19:-1),t(),v(d.loading()&&!d.error()?20:-1),t(),v(!d.loading()&&!d.error()?21:-1))},dependencies:[N,$,O],encapsulation:2,changeDetection:0});let i=s;return i})();export{Be as ModelsListComponent};
