import{a as ne}from"./chunk-OEB6SJOZ.js";import{a as ie}from"./chunk-JSI25OHT.js";import{a as ee}from"./chunk-QWPHJZNM.js";import{a as te}from"./chunk-CRVG2NOB.js";import{b as J,d as K,e as W}from"./chunk-3B2Y74WR.js";import"./chunk-ELF6RP2M.js";import"./chunk-YL3TDIGQ.js";import"./chunk-LN47MBAJ.js";import{a as Z}from"./chunk-OBD3L7BG.js";import"./chunk-PZF2KSPB.js";import{c as Y}from"./chunk-MXBDCOJX.js";import{l as G}from"./chunk-JHAYVYNF.js";import{k as V,m as X}from"./chunk-BPDV6QKT.js";import{Cb as x,Db as p,Kb as z,Lb as Q,Oa as t,Ob as L,Rb as l,Sb as u,Tb as h,X as b,Za as P,aa as y,ba as S,ca as D,da as H,dc as w,ga as $,gc as d,hc as m,ic as E,ja as k,nb as R,nc as B,ob as _,oc as A,pb as f,r as M,rb as U,sb as N,sc as q,tb as F,ub as s,vb as o,wb as j,zb as I}from"./chunk-4EEEF725.js";import"./chunk-4CLCTAJ7.js";var oe=["highlightedTeam"],ae=e=>({ownerId:e}),re=e=>["/details/teams",e],se=e=>({count:e}),le=e=>({name:e}),ce=(e,c)=>c.id;function de(e,c){if(e&1){let i=I();s(0,"div",2)(1,"div",18)(2,"span",19),l(3),d(4,"transloco"),o(),s(5,"button",20),x("click",function(){y(i);let r=p();return S(r.clearOwnerFilter())}),l(6),d(7,"transloco"),o()()()}if(e&2){let i=p();t(3),h(" ",E(4,2,"details.teams.filtering_by_owner",w(7,ae,i.filterOwnerId()))," "),t(3),h(" ",m(7,5,"details.teams.clear_filter")," ")}}function me(e,c){if(e&1){let i=I();s(0,"div",3)(1,"div",21)(2,"p",22),l(3),d(4,"transloco"),o(),s(5,"button",23),x("click",function(){y(i);let r=p();return S(r.clearOwnerFilter())}),l(6),d(7,"transloco"),o()()()}if(e&2){let i=p();t(3),h(" ",E(4,2,"details.teams.owner_not_found",w(7,ae,i.filterOwnerId()))," "),t(3),h(" ",m(7,5,"details.teams.view_all_teams")," ")}}function pe(e,c){if(e&1&&(s(0,"span"),l(1),o()),e&2){let i=p();t(),u(i.sortOrder()==="asc"?"\u2191":"\u2193")}}function he(e,c){if(e&1&&(s(0,"span"),l(1),o()),e&2){let i=p();t(),u(i.sortOrder()==="asc"?"\u2191":"\u2193")}}function ue(e,c){if(e&1&&(s(0,"span"),l(1),o()),e&2){let i=p();t(),u(i.sortOrder()==="asc"?"\u2191":"\u2193")}}function _e(e,c){e&1&&(s(0,"p",15),l(1),d(2,"transloco"),o()),e&2&&(t(),u(m(2,1,"details.teams.loading")))}function fe(e,c){if(e&1){let i=I();s(0,"div",16)(1,"p",24),l(2),o(),s(3,"button",25),x("click",function(){y(i);let r=p();return S(r.refresh())}),l(4),d(5,"transloco"),o()()}if(e&2){let i=p();t(2),u(i.error()),t(2),u(m(5,2,"details.teams.retry"))}}function xe(e,c){e&1&&(s(0,"p",15),l(1),d(2,"transloco"),o()),e&2&&(t(),u(m(2,1,"details.teams.no_results")))}function ge(e,c){e&1&&(s(0,"p",15),l(1),d(2,"transloco"),o()),e&2&&(t(),u(m(2,1,"details.teams.no_teams")))}function Ce(e,c){if(e&1&&_(0,xe,3,3,"p",15)(1,ge,3,3,"p",15),e&2){let i=p();f(i.searchText()?0:1)}}function Te(e,c){if(e&1){let i=I();s(0,"button",37),d(1,"transloco"),x("click",function(r){return y(i),p(3).clearHighlight(),r.preventDefault(),S(r.stopPropagation())}),l(2),d(3,"transloco"),s(4,"span",38),l(5,"\xD7"),o()()}e&2&&(R("aria-label",m(1,2,"details.common.clear_highlight")),t(2),h(" ",m(3,4,"details.common.highlighted")," "))}function ve(e,c){if(e&1&&(s(0,"p",31),l(1),o()),e&2){let i=p().$implicit;t(),u(i.info)}}function be(e,c){if(e&1&&(s(0,"p",36),l(1),d(2,"transloco"),o()),e&2){let i=p().$implicit;t(),h(" ",E(2,1,"details.teams.created_by",w(4,le,i.creator))," ")}}function ke(e,c){if(e&1&&(s(0,"a",27,0)(2,"div",28)(3,"h3",29),l(4),o(),_(5,Te,6,6,"button",30),o(),_(6,ve,2,1,"p",31),s(7,"div",32)(8,"span",33),D(),s(9,"svg",34),j(10,"path",35),o(),l(11),d(12,"transloco"),o(),H(),s(13,"span",33),l(14),d(15,"formatNumber"),o()(),_(16,be,3,6,"p",36),o()),e&2){let i=c.$implicit,n=p(2);L("entity-card-highlighted",n.isTeamHighlighted(i.id)),F("routerLink",w(14,re,i.id)),t(4),h(" ",i.name," "),t(),f(n.isTeamHighlighted(i.id)?5:-1),t(),f(i.info?6:-1),t(5),h(" ",E(12,9,"details.teams.workers_count",w(16,se,i.worker_count??0))," "),t(3),h(" ",m(15,12,i.kudos??0)," generated kudos "),t(2),f(i.creator?16:-1)}}function we(e,c){if(e&1&&(s(0,"div",17),U(1,ke,17,18,"a",26,ce),o()),e&2){let i=p();t(),N(i.filteredTeams())}}var Re=(()=>{let c=class c{isTeamHighlighted(n){return n?this.highlightTeamId()===n:!1}constructor(){this.title=b(G),this.translator=b(Z),this.teamService=b(ee),this.destroyRef=b($),this.route=b(J),this.router=b(K),this.params=X(this.route.params,{initialValue:{}}),this.filterOwnerId=B(()=>this.params().ownerId??null),this.highlightTeamId=B(()=>this.params().highlightTeamId??null),this.highlightedTeam=q("highlightedTeam"),this.teams=k([]),this.loading=k(!0),this.error=k(null),this.searchText=k(""),this.sortBy=k("kudos"),this.sortOrder=k("desc"),this.filteredTeams=B(()=>{let n=this.teams(),r=this.filterOwnerId();r&&(n=n.filter(g=>{let v=ie(g.creator);return v!==null&&v.toString()===r}));let a=this.searchText().toLowerCase().trim();a&&(n=n.filter(g=>g.name?.toLowerCase().includes(a)||g.info?.toLowerCase().includes(a)||g.creator?.toLowerCase().includes(a)));let C=this.sortBy(),T=this.sortOrder()==="asc"?1:-1,O=this.highlightTeamId();return[...n].sort((g,v)=>{if(O){if(g.id===O)return-1;if(v.id===O)return 1}switch(C){case"name":return(g.name??"").localeCompare(v.name??"")*T;case"workers":return((g.worker_count??0)-(v.worker_count??0))*T;case"kudos":return((g.kudos??0)-(v.kudos??0))*T;default:return 0}})}),this.ownerNotFound=B(()=>this.filterOwnerId()?!this.loading()&&this.teams().length>0&&this.filteredTeams().length===0:!1),A(()=>{let n=this.highlightTeamId(),r=this.filteredTeams(),a=this.highlightedTeam();n&&r.length>0&&a&&setTimeout(()=>{a.nativeElement.scrollIntoView({behavior:"smooth",block:"center"})},100)})}ngOnInit(){M([this.translator.get("details.teams.title"),this.translator.get("app_title")]).pipe(V(this.destroyRef)).subscribe(([n,r])=>{this.title.setTitle(`${n} | ${r}`)}),this.loadTeams()}loadTeams(){this.loading.set(!0),this.error.set(null),this.teamService.getTeams().pipe(V(this.destroyRef)).subscribe({next:n=>{this.teams.set(n),this.loading.set(!1)},error:()=>{this.error.set("Failed to load teams"),this.loading.set(!1)}})}refresh(){this.loadTeams()}onSearchChange(n){let r=n.target;this.searchText.set(r.value)}onSortChange(n){this.sortBy()===n?this.sortOrder.set(this.sortOrder()==="asc"?"desc":"asc"):(this.sortBy.set(n),this.sortOrder.set("asc"))}formatUptime(n){let r=Math.floor(n/86400),a=Math.floor(n%86400/3600);return r>0?`${r}d ${a}h`:`${a}h`}onTeamSearch(n){let r=n.trim();r&&this.router.navigate(["/details/teams",r])}clearOwnerFilter(){this.router.navigate(["/details/teams"],{replaceUrl:!0})}clearHighlight(){this.router.navigate(["/details/teams"],{replaceUrl:!0}),window.scrollTo({top:0,behavior:"smooth"})}};c.\u0275fac=function(r){return new(r||c)},c.\u0275cmp=P({type:c,selectors:[["app-teams-list"]],viewQuery:function(r,a){r&1&&z(a.highlightedTeam,oe,5),r&2&&Q()},decls:39,vars:38,consts:[["highlightedTeam",""],["label","details.teams.lookup.label","placeholder","details.teams.lookup.placeholder","hintText","details.teams.lookup.hint",3,"search"],[1,"filter-notice","mb-4"],[1,"card","card-bg-primary","card-full","card-spaced","mb-4"],[1,"card","card-bg-primary","card-full","card-spaced"],[1,"page-section-header"],[1,"heading-card"],[1,"worker-btn","text-sm",3,"click","disabled"],[1,"form-row","mb-6"],[1,"form-field"],["for","team-search",1,"form-label","text-sm"],["type","text","id","team-search",1,"form-input",3,"input","value","placeholder"],[1,"form-label","text-sm"],[1,"btn-group"],[1,"worker-btn","text-sm",3,"click"],[1,"text-secondary","text-center","py-8"],[1,"text-center","py-8"],[1,"data-grid-1-2-3"],[1,"filter-notice-content"],[1,"filter-notice-text"],["type","button",1,"btn","btn-secondary","btn-sm",3,"click"],[1,"text-center","py-6"],[1,"text-secondary","mb-4"],["type","button",1,"btn","btn-primary",3,"click"],[1,"text-red-500","mb-4"],[1,"btn-primary",3,"click"],[1,"entity-card-link",3,"routerLink","entity-card-highlighted"],[1,"entity-card-link",3,"routerLink"],[1,"flex","items-start","justify-between","gap-2","mb-2"],[1,"heading-item","entity-card-title"],["type","button",1,"badge-base","badge-warning","badge-dismissible","shrink-0"],[1,"text-secondary","text-sm","line-clamp-2","mb-3"],[1,"entity-card-stats"],[1,"entity-card-stat"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"],[1,"text-xs","text-secondary","mt-2"],["type","button",1,"badge-base","badge-warning","badge-dismissible","shrink-0",3,"click"],["aria-hidden","true"]],template:function(r,a){r&1&&(s(0,"app-entity-lookup",1),x("search",function(T){return a.onTeamSearch(T)}),o(),_(1,de,8,9,"div",2),_(2,me,8,9,"div",3),s(3,"div",4)(4,"div",5)(5,"h2",6),l(6),d(7,"transloco"),o(),s(8,"button",7),x("click",function(){return a.refresh()}),l(9),d(10,"transloco"),o()(),s(11,"div",8)(12,"div",9)(13,"label",10),l(14),d(15,"transloco"),o(),s(16,"input",11),d(17,"transloco"),x("input",function(T){return a.onSearchChange(T)}),o()(),s(18,"div")(19,"label",12),l(20),d(21,"transloco"),o(),s(22,"div",13)(23,"button",14),x("click",function(){return a.onSortChange("name")}),l(24),d(25,"transloco"),_(26,pe,2,1,"span"),o(),s(27,"button",14),x("click",function(){return a.onSortChange("workers")}),l(28),d(29,"transloco"),_(30,he,2,1,"span"),o(),s(31,"button",14),x("click",function(){return a.onSortChange("kudos")}),l(32),d(33,"transloco"),_(34,ue,2,1,"span"),o()()()(),_(35,_e,3,3,"p",15)(36,fe,6,4,"div",16)(37,Ce,2,1)(38,we,3,0,"div",17),o()),r&2&&(t(),f(a.filterOwnerId()?1:-1),t(),f(a.ownerNotFound()?2:-1),t(4),u(m(7,22,"details.teams.title")),t(2),F("disabled",a.loading()),t(),h(" ",m(10,24,"details.teams.refresh")," "),t(5),h(" ",m(15,26,"details.teams.search")," "),t(2),F("value",a.searchText())("placeholder",m(17,28,"details.teams.search_placeholder")),t(4),u(m(21,30,"details.teams.sort_by")),t(3),L("worker-btn-active",a.sortBy()==="name"),t(),h(" ",m(25,32,"details.teams.sort.name")," "),t(2),f(a.sortBy()==="name"?26:-1),t(),L("worker-btn-active",a.sortBy()==="workers"),t(),h(" ",m(29,34,"details.teams.sort.workers")," "),t(2),f(a.sortBy()==="workers"?30:-1),t(),L("worker-btn-active",a.sortBy()==="kudos"),t(),h(" ",m(33,36,"details.teams.sort.kudos")," "),t(2),f(a.sortBy()==="kudos"?34:-1),t(),f(a.loading()?35:a.error()?36:a.filteredTeams().length===0?37:38))},dependencies:[Y,W,te,ne],encapsulation:2,changeDetection:0});let e=c;return e})();export{Re as TeamsListComponent};
