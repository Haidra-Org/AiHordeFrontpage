import{a as ne,b as oe}from"./chunk-DY5J6W22.js";import{a as re}from"./chunk-UQV72EDM.js";import{c as te,d as ie}from"./chunk-BMIYH3UD.js";import{a as O}from"./chunk-Z4QX4XJM.js";import{e as ee}from"./chunk-T4BZNTIM.js";import{g as Z,k as F}from"./chunk-GZDNXZTC.js";import{A as B,Cb as w,Db as _,Oa as i,Qb as Q,Rb as d,S as H,Sb as x,Tb as m,Ub as L,X as E,Za as X,aa as v,ba as g,ca as b,cc as Y,da as q,dc as W,ga as z,gc as p,hc as c,ic as I,ja as T,k as y,ob as u,pb as C,q as N,qb as J,qc as j,rb as P,rc as D,sb as $,tb as k,ub as o,vb as r,w as K,wb as h,zb as S}from"./chunk-QF4LG6ZD.js";var ae=(()=>{let a=class a{constructor(){this.httpClient=E(Z),this.auth=E(O),this.baseUrl="https://aihorde.net/api/v2"}getWorkers(){let n=this.auth.getStoredApiKey(),l=n?{headers:{apikey:n}}:{};return this.httpClient.get(`${this.baseUrl}/workers`,l).pipe(B(()=>y([])))}getWorker(n){let l=this.auth.getStoredApiKey(),s=l?{headers:{apikey:l}}:{};return this.httpClient.get(`${this.baseUrl}/workers/${n}`,s).pipe(B(()=>y(null)))}getWorkersByIds(n){if(!n||n.length===0)return y([]);let l=n.map(s=>this.getWorker(s));return K(l).pipe(N(s=>s.filter(f=>f!==null)),B(()=>y([])))}updateWorker(n,l){let s=this.auth.getStoredApiKey();return s?this.httpClient.put(`${this.baseUrl}/workers/${n}`,l,{headers:{apikey:s}}).pipe(B(()=>y(null))):y(null)}setMaintenance(n,l,s){let f={maintenance:l,maintenance_msg:l?s:""};return this.updateWorker(n,f)}setPaused(n,l){return this.updateWorker(n,{paused:l})}deleteWorker(n){let l=this.auth.getStoredApiKey();return l?this.httpClient.delete(`${this.baseUrl}/workers/${n}`,{headers:{apikey:l}}).pipe(B(()=>y(null))):y(null)}};a.\u0275fac=function(l){return new(l||a)},a.\u0275prov=H({token:a,factory:a.\u0275fac,providedIn:"root"});let e=a;return e})();var M=e=>({name:e}),de=e=>["/admin/users",e],se=()=>[],pe=(e,a)=>a.message;function ce(e,a){e&1&&(o(0,"div",0),b(),o(1,"svg",32),h(2,"path",33),r(),q(),o(3,"span"),d(4),p(5,"transloco"),r()()),e&2&&(i(4),x(c(5,1,"admin.workers.success")))}function me(e,a){if(e&1&&(o(0,"li",45),d(1),r()),e&2){let t=a.$implicit;i(),x(t)}}function _e(e,a){if(e&1&&(o(0,"ul",44),P(1,me,2,1,"li",45,J),r()),e&2){let t=_(4);i(),$(t.getFilteredModels())}}function ue(e,a){e&1&&(o(0,"p",38),d(1),p(2,"transloco"),r()),e&2&&(i(),m(" ",c(2,1,"admin.workers.dialog.no_models_match")," "))}function Ce(e,a){if(e&1){let t=S();o(0,"div",41)(1,"input",42),p(2,"transloco"),w("input",function(l){v(t);let s=_(3);return g(s.onModelSearchChange(l))}),r()(),o(3,"div",43),u(4,_e,3,0,"ul",44)(5,ue,3,3,"p",38),r()}if(e&2){let t=_(3);i(),k("value",t.modelSearch())("placeholder",c(2,3,"admin.workers.dialog.search_models")),i(3),C(t.getFilteredModels().length>0?4:5)}}function ke(e,a){e&1&&(o(0,"p",38),d(1),p(2,"transloco"),r()),e&2&&(i(),m(" ",c(2,1,"admin.common.none")," "))}function xe(e,a){if(e&1){let t=S();o(0,"h3",36),d(1),p(2,"transloco"),o(3,"span",37),d(4),r()(),u(5,Ce,6,5)(6,ke,3,3,"p",38),o(7,"div",39)(8,"button",40),w("click",function(){v(t);let l=_(2);return g(l.closeDialog())}),d(9),p(10,"transloco"),r()()}if(e&2){let t=_(2);i(),m(" ",I(2,4,"admin.workers.dialog.models_title",W(9,M,t.worker().name))," "),i(3),m("(",t.getSortedModels().length,")"),i(),C(t.getSortedModels().length>0?5:6),i(4),m(" ",c(10,7,"admin.workers.dialog.close")," ")}}function we(e,a){if(e&1&&(d(0),p(1,"transloco")),e&2){let t=_(3);m(" ",I(1,1,"admin.workers.dialog.unset_maintenance_title",W(4,M,t.worker().name))," ")}}function fe(e,a){if(e&1&&(d(0),p(1,"transloco")),e&2){let t=_(3);m(" ",I(1,1,"admin.workers.dialog.set_maintenance_title",W(4,M,t.worker().name))," ")}}function ve(e,a){if(e&1){let t=S();o(0,"div",41)(1,"label",49),d(2),p(3,"transloco"),r(),o(4,"textarea",50),w("input",function(l){v(t);let s=_(3);return g(s.onMaintenanceReasonChange(l))}),r()()}if(e&2){let t=_(3);i(2),m(" ",c(3,2,"admin.workers.dialog.maintenance_reason")," "),i(2),k("value",t.maintenanceReason())}}function ge(e,a){if(e&1){let t=S();o(0,"h3",36),u(1,we,2,6)(2,fe,2,6),r(),u(3,ve,5,4,"div",41),o(4,"div",46)(5,"button",47),w("click",function(){v(t);let l=_(2);return g(l.closeDialog())}),d(6),p(7,"transloco"),r(),o(8,"button",48),w("click",function(){v(t);let l=_(2);return g(l.confirmMaintenance())}),d(9),p(10,"transloco"),r()()}if(e&2){let t=_(2);i(),C(t.worker().maintenance_mode?1:2),i(2),C(t.worker().maintenance_mode?-1:3),i(3),m(" ",c(7,5,"admin.workers.dialog.cancel")," "),i(2),k("disabled",t.isUpdating()),i(),m(" ",c(10,7,"admin.workers.dialog.confirm")," ")}}function he(e,a){if(e&1&&(d(0),p(1,"transloco")),e&2){let t=_(3);m(" ",I(1,1,"admin.workers.dialog.unset_paused_title",W(4,M,t.worker().name))," ")}}function Se(e,a){if(e&1&&(d(0),p(1,"transloco")),e&2){let t=_(3);m(" ",I(1,1,"admin.workers.dialog.set_paused_title",W(4,M,t.worker().name))," ")}}function be(e,a){if(e&1){let t=S();o(0,"h3",36),u(1,he,2,6)(2,Se,2,6),r(),o(3,"div",46)(4,"button",47),w("click",function(){v(t);let l=_(2);return g(l.closeDialog())}),d(5),p(6,"transloco"),r(),o(7,"button",51),w("click",function(){v(t);let l=_(2);return g(l.confirmPause())}),d(8),p(9,"transloco"),r()()}if(e&2){let t=_(2);i(),C(t.worker().paused?1:2),i(4),m(" ",c(6,4,"admin.workers.dialog.cancel")," "),i(2),k("disabled",t.isUpdating()),i(),m(" ",c(9,6,"admin.workers.dialog.confirm")," ")}}function ye(e,a){e&1&&(o(0,"div",53)(1,"p",58),d(2),p(3,"transloco"),r()()),e&2&&(i(2),m(" ",c(3,1,"admin.workers.dialog.delete_error")," "))}function Ee(e,a){if(e&1){let t=S();o(0,"h3",36),d(1),p(2,"transloco"),r(),o(3,"div",52)(4,"div",53)(5,"p",54),d(6),p(7,"transloco"),r()(),o(8,"div",55)(9,"p",56),d(10),p(11,"transloco"),r()(),u(12,ye,4,3,"div",53),r(),o(13,"div",46)(14,"button",47),w("click",function(){v(t);let l=_(2);return g(l.closeDialog())}),d(15),p(16,"transloco"),r(),o(17,"button",57),w("click",function(){v(t);let l=_(2);return g(l.confirmDelete())}),d(18),p(19,"transloco"),r()()}if(e&2){let t=_(2);i(),m(" ",I(2,7,"admin.workers.dialog.delete_title",W(18,M,t.worker().name))," "),i(5),m(" ",c(7,10,"admin.workers.dialog.delete_warning_permanent")," "),i(4),m(" ",c(11,12,"admin.workers.dialog.delete_warning_offline_requirement")," "),i(2),C(t.deleteError()?12:-1),i(3),m(" ",c(16,14,"admin.workers.dialog.cancel")," "),i(2),k("disabled",t.isUpdating()),i(),m(" ",c(19,16,"admin.workers.dialog.delete_confirm")," ")}}function Te(e,a){if(e&1){let t=S();o(0,"div",1)(1,"div",34),w("click",function(){v(t);let l=_();return g(l.closeDialog())}),r(),o(2,"div",35),u(3,xe,11,11)(4,ge,11,9)(5,be,10,8)(6,Ee,20,20),r()()}if(e&2){let t,n=_();i(3),C((t=n.dialogType())==="models"?3:t==="maintenance"?4:t==="pause"?5:t==="delete"?6:-1)}}function We(e,a){e&1&&(o(0,"div",5),p(1,"transloco"),b(),o(2,"svg",32),h(3,"path",33),r()()),e&2&&k("title",c(1,1,"admin.workers.card.online"))}function Ie(e,a){e&1&&(o(0,"div",6),p(1,"transloco"),b(),o(2,"svg",32),h(3,"path",59),r()()),e&2&&k("title",c(1,1,"admin.workers.card.issue"))}function Be(e,a){e&1&&(o(0,"span",10),d(1),p(2,"transloco"),r()),e&2&&(i(),x(c(2,1,"admin.workers.type.image")))}function Me(e,a){e&1&&(o(0,"span",11),d(1),p(2,"transloco"),r()),e&2&&(i(),x(c(2,1,"admin.workers.type.text")))}function Ve(e,a){e&1&&(o(0,"span",12),d(1),p(2,"transloco"),r()),e&2&&(i(),x(c(2,1,"admin.workers.type.interrogation")))}function Ue(e,a){e&1&&(o(0,"div",15),p(1,"transloco"),b(),o(2,"svg",60),h(3,"path",61),r()()),e&2&&k("title",c(1,1,"admin.workers.card.low_speed_warning"))}function De(e,a){e&1&&(o(0,"div",15),p(1,"transloco"),b(),o(2,"svg",62),h(3,"path",61),r()()),e&2&&k("title",c(1,1,"admin.workers.card.high_speed_warning"))}function Fe(e,a){e&1&&(o(0,"div",15),p(1,"transloco"),b(),o(2,"svg",63),h(3,"path",64),r()()),e&2&&k("title",c(1,1,"admin.workers.card.paused"))}function Oe(e,a){e&1&&(o(0,"div",15),p(1,"transloco"),b(),o(2,"svg",63),h(3,"path",65),r()()),e&2&&k("title",c(1,1,"admin.workers.card.maintenance"))}function Pe(e,a){e&1&&(o(0,"div",15),p(1,"transloco"),b(),o(2,"svg",63),h(3,"path",66),r()()),e&2&&k("title",c(1,1,"admin.workers.card.flagged"))}function $e(e,a){e&1&&(o(0,"div",15),p(1,"transloco"),b(),o(2,"svg",67),h(3,"path",68),r()()),e&2&&k("title",c(1,1,"admin.workers.card.trusted"))}function Le(e,a){if(e&1&&(o(0,"a",20),d(1),r()),e&2){let t=_();k("routerLink",W(3,de,t.getOwnerUserId()))("title",t.worker().owner),i(),x(t.getOwnerDisplayName())}}function je(e,a){if(e&1&&(o(0,"span",21),d(1),r()),e&2){let t=_();k("title",t.worker().owner??""),i(),x(t.getOwnerDisplayName())}}function Ge(e,a){if(e&1&&(o(0,"div",18)(1,"span",19),d(2),p(3,"transloco"),r(),o(4,"span",69),d(5),r()()),e&2){let t,n,l=_();i(2),m("",c(3,3,"admin.workers.card.team"),":"),i(2),k("title",((t=l.worker().team)==null?null:t.name)??((t=l.worker().team)==null?null:t.id)??""),i(),x(((n=l.worker().team)==null?null:n.name)??((n=l.worker().team)==null?null:n.id)??"")}}function Re(e,a){if(e&1&&(o(0,"span",21),d(1),r()),e&2){let t=a,n=_();k("title",n.worker().bridge_agent),i(),L("",t.name," v",t.version)}}function Ae(e,a){if(e&1&&(o(0,"span",21),d(1),r()),e&2){let t=_();k("title",t.worker().bridge_agent),i(),x(t.worker().bridge_agent)}}function Ne(e,a){e&1&&(o(0,"div",22)(1,"span",19),d(2),p(3,"transloco"),r(),o(4,"span",70),d(5),r()()),e&2&&(i(2),m("",c(3,2,"admin.workers.card.software_contact"),":"),i(3),x(a.contact))}function Ke(e,a){if(e&1&&(o(0,"div",22)(1,"span",19),d(2),p(3,"transloco"),r(),o(4,"span",70),d(5),r()()),e&2){let t=_();i(2),m("",c(3,2,"admin.workers.card.contact"),":"),i(3),x(t.worker().contact)}}function He(e,a){if(e&1&&(o(0,"div",18)(1,"span",19),d(2),p(3,"transloco"),r(),o(4,"span",71),d(5),r()()),e&2){let t=_();i(2),m("",c(3,2,"admin.workers.card.ipaddr"),":"),i(3),x(t.worker().ipaddr)}}function qe(e,a){if(e&1&&(o(0,"span",24),d(1),h(2,"app-unit-tooltip",72),r()),e&2){let t=a;i(),m(" ",t.primary.value.toFixed(2)," "),i(),k("unit",t)("primaryOverride",t.primary.unit)}}function ze(e,a){if(e&1&&(o(0,"span",24),d(1),r()),e&2){let t=_();i(),x(t.worker().performance)}}function Xe(e,a){if(e&1&&(o(0,"span",24),d(1),h(2,"app-unit-tooltip",72),r()),e&2){let t=a;i(),m(" ",t.primary.value.toFixed(1)," "),i(),k("unit",t)("primaryOverride",t.primary.prefix+t.primary.unit)}}function Je(e,a){if(e&1&&(o(0,"span",24),d(1),p(2,"formatNumber"),r()),e&2){let t=_(2);i(),x(c(2,1,t.worker().megapixelsteps_generated??0))}}function Qe(e,a){if(e&1&&(o(0,"div",18)(1,"span",19),d(2),p(3,"transloco"),r(),u(4,Xe,3,3,"span",24)(5,Je,3,3,"span",24),r()),e&2){let t,n=_();i(2),m("",c(3,2,"admin.workers.card.mps_generated"),":"),i(2),C((t=n.getMpsGeneratedUnit())?4:5,t)}}function Ye(e,a){if(e&1&&(o(0,"span",24),d(1),h(2,"app-unit-tooltip",72),r()),e&2){let t=a;i(),m(" ",t.primary.value.toFixed(1)," "),i(),k("unit",t)("primaryOverride",t.primary.prefix+t.primary.unit)}}function Ze(e,a){if(e&1&&(o(0,"span",24),d(1),p(2,"formatNumber"),r()),e&2){let t=_(2);i(),x(c(2,1,t.worker().tokens_generated??0))}}function et(e,a){if(e&1&&(o(0,"div",18)(1,"span",19),d(2),p(3,"transloco"),r(),u(4,Ye,3,3,"span",24)(5,Ze,3,3,"span",24),r()),e&2){let t,n=_();i(2),m("",c(3,2,"admin.workers.card.tokens_generated"),":"),i(2),C((t=n.getTokensGeneratedUnit())?4:5,t)}}function tt(e,a){if(e&1&&(o(0,"div",22)(1,"span",19),d(2),p(3,"transloco"),r(),o(4,"span",73),d(5),r()()),e&2){let t=_(2);i(2),m("",c(3,2,"admin.workers.card.model_loaded"),":"),i(3),x(t.worker().models[0])}}function it(e,a){if(e&1&&(o(0,"div",18)(1,"span",19),d(2),p(3,"transloco"),r(),o(4,"span",24),d(5),r()()),e&2){let t,n=_(2);i(2),m("",c(3,2,"admin.workers.card.models_loaded"),":"),i(3),x(((t=n.worker().models)==null?null:t.length)??0)}}function nt(e,a){if(e&1&&u(0,tt,6,4,"div",22)(1,it,6,4,"div",18),e&2){let t,n=_();C((((t=n.worker().models)==null?null:t.length)??0)===1?0:1)}}function ot(e,a){if(e&1&&(o(0,"div",18)(1,"span",19),d(2),p(3,"transloco"),r(),o(4,"span",24),d(5),r()()),e&2){let t,n=_();i(2),m("",c(3,2,"admin.workers.card.forms"),":"),i(3),x(((t=n.worker().forms)==null?null:t.join(", "))??"")}}function rt(e,a){e&1&&(o(0,"span",76),d(1,"img2img"),r())}function at(e,a){e&1&&(o(0,"span",76),d(1,"inpainting"),r())}function lt(e,a){e&1&&(o(0,"span",76),d(1,"post-processing"),r())}function dt(e,a){e&1&&(o(0,"span",76),d(1,"LoRA"),r())}function st(e,a){e&1&&(o(0,"span",76),d(1,"ControlNet"),r())}function pt(e,a){e&1&&(o(0,"span",76),d(1,"SDXL ControlNet"),r())}function ct(e,a){if(e&1&&(o(0,"div",26)(1,"span",74),d(2),p(3,"transloco"),r(),o(4,"div",75),u(5,rt,2,0,"span",76),u(6,at,2,0,"span",76),u(7,lt,2,0,"span",76),u(8,dt,2,0,"span",76),u(9,st,2,0,"span",76),u(10,pt,2,0,"span",76),r()()),e&2){let t=_();i(2),m("",c(3,7,"admin.workers.card.capabilities"),":"),i(3),C(t.worker().img2img?5:-1),i(),C(t.worker().painting?6:-1),i(),C(t.worker()["post-processing"]?7:-1),i(),C(t.worker().lora?8:-1),i(),C(t.worker().controlnet?9:-1),i(),C(t.worker().sdxl_controlnet?10:-1)}}function mt(e,a){if(e&1&&(o(0,"span",79),d(1),r()),e&2){let t=_().$implicit;i(),m("(",t.origin,")")}}function _t(e,a){if(e&1&&(o(0,"div",78)(1,"span",24),d(2),r(),u(3,mt,2,1,"span",79),r()),e&2){let t=a.$implicit;i(2),x(t.message),i(),C(t.origin?3:-1)}}function ut(e,a){if(e&1&&(o(0,"div",26)(1,"span",74),d(2),p(3,"transloco"),r(),o(4,"div",77),P(5,_t,4,2,"div",78,pe),r()()),e&2){let t,n=_();i(2),L("",c(3,2,"admin.workers.card.messages")," (",((t=n.worker().messages)==null?null:t.length)??0,"):"),i(3),$(n.worker().messages??Y(4,se))}}function Ct(e,a){e&1&&(d(0),p(1,"transloco")),e&2&&m(" ",c(1,1,"admin.workers.button.disable_maintenance")," ")}function kt(e,a){e&1&&(d(0),p(1,"transloco")),e&2&&m(" ",c(1,1,"admin.workers.button.maintenance")," ")}function xt(e,a){if(e&1){let t=S();o(0,"button",80),p(1,"transloco"),w("click",function(){v(t);let l=_();return g(l.openMaintenanceDialog())}),u(2,Ct,2,3)(3,kt,2,3),r()}if(e&2){let t=_();k("title",c(1,2,"admin.workers.button.maintenance_tooltip")),i(2),C(t.worker().maintenance_mode?2:3)}}function wt(e,a){e&1&&(d(0),p(1,"transloco")),e&2&&m(" ",c(1,1,"admin.workers.button.unpause")," ")}function ft(e,a){e&1&&(d(0),p(1,"transloco")),e&2&&m(" ",c(1,1,"admin.workers.button.pause")," ")}function vt(e,a){if(e&1){let t=S();o(0,"button",81),p(1,"transloco"),p(2,"transloco"),w("click",function(){v(t);let l=_();return g(l.openPauseDialog())}),u(3,wt,2,3)(4,ft,2,3),r()}if(e&2){let t=_();k("title",t.worker().paused?c(1,2,"admin.workers.action.unset_paused"):c(2,4,"admin.workers.action.set_paused")),i(3),C(t.worker().paused?3:4)}}function gt(e,a){if(e&1){let t=S();o(0,"button",82),p(1,"transloco"),w("click",function(){v(t);let l=_();return g(l.openDeleteDialog())}),d(2),p(3,"transloco"),r()}e&2&&(k("title",c(1,2,"admin.workers.action.delete")),i(2),m(" ",c(3,4,"admin.workers.button.delete")," "))}var jt=(()=>{let a=class a{constructor(){this.workerService=E(ae),this.destroyRef=E(z),this.auth=E(O),this.unitConversion=E(oe),this.worker=D.required(),this.isModerator=D(!1),this.viewMode=D("admin"),this.workerUpdated=j(),this.workerDeleted=j(),this.dialogOpen=T(!1),this.dialogType=T("models"),this.maintenanceReason=T(""),this.modelSearch=T(""),this.isUpdating=T(!1),this.showSuccess=T(!1),this.deleteError=T(null)}get isUserModerator(){return this.auth.currentUser()?.moderator??!1}getOwnerUserId(){let n=this.worker().owner;if(!n)return null;let l=n.match(/#(\d+)$/);return l?l[1]:null}isOwnedByCurrentUser(){let n=this.getOwnerUserId(),l=this.auth.currentUser()?.id;return!!n&&!!l&&n===`${l}`}canToggleMaintenance(){return this.isOwnedByCurrentUser()||this.isModerator()}canTogglePause(){return this.viewMode()==="admin"&&this.isUserModerator}canDelete(){return this.isOwnedByCurrentUser()||this.isModerator()}getOwnerDisplayName(){return this.worker().owner??"Unknown"}isHighSpeed(){return this.worker().type==="image"?parseFloat(this.worker().performance)>3:!1}isLowSpeed(){return this.worker().type==="image"?parseFloat(this.worker().performance)<.4:!1}hasIssue(){let n=this.worker();return!n.online||n.paused||n.maintenance_mode||n.flagged}hasImageCapabilities(){let n=this.worker();return!!(n.img2img||n.painting||n["post-processing"]||n.lora||n.controlnet||n.sdxl_controlnet)}getCardBackground(){let n=this.worker();return n.maintenance_mode||n.paused||n.flagged?"worker-card-issue":"worker-card-normal"}formatUptime(n){let l=Math.floor(n/86400),s=Math.floor(n%86400/3600),f=Math.floor(n%3600/60);return l>0?`${l}d ${s}h`:s>0?`${s}h ${f}m`:`${f}m`}truncateName(n,l=30){return n.length>l?n.substring(0,l)+"...":n}getParsedBridgeAgent(){let n=this.worker().bridge_agent;if(!n)return null;let l=n.indexOf(":");if(l===-1)return null;let s=n.indexOf(":",l+1);if(s===-1)return null;let f=n.substring(0,l),V=n.substring(l+1,s),U=n.substring(s+1);return!f||!V||!U?null:{name:f,version:V,contact:U}}getSortedModels(){return[...this.worker().models??[]].sort((n,l)=>n.toLowerCase().localeCompare(l.toLowerCase()))}getFilteredModels(){let n=this.modelSearch().toLowerCase().trim();return n?this.getSortedModels().filter(l=>l.toLowerCase().includes(n)):this.getSortedModels()}onModelSearchChange(n){let l=n.target;this.modelSearch.set(l.value)}openModelsDialog(){this.dialogType.set("models"),this.modelSearch.set(""),this.dialogOpen.set(!0)}openMaintenanceDialog(){this.dialogType.set("maintenance"),this.maintenanceReason.set(""),this.dialogOpen.set(!0)}openPauseDialog(){this.dialogType.set("pause"),this.dialogOpen.set(!0)}closeDialog(){this.dialogOpen.set(!1)}onMaintenanceReasonChange(n){let l=n.target;this.maintenanceReason.set(l.value)}confirmMaintenance(){this.isUpdating.set(!0);let n=!this.worker().maintenance_mode;this.workerService.setMaintenance(this.worker().id,n,this.maintenanceReason()).pipe(F(this.destroyRef)).subscribe(l=>{this.isUpdating.set(!1),l&&(this.showSuccess.set(!0),setTimeout(()=>this.showSuccess.set(!1),3e3),this.workerUpdated.emit()),this.closeDialog()})}confirmPause(){this.isUpdating.set(!0);let n=!this.worker().paused;this.workerService.setPaused(this.worker().id,n).pipe(F(this.destroyRef)).subscribe(l=>{this.isUpdating.set(!1),l&&(this.showSuccess.set(!0),setTimeout(()=>this.showSuccess.set(!1),3e3),this.workerUpdated.emit()),this.closeDialog()})}openDeleteDialog(){this.dialogType.set("delete"),this.deleteError.set(null),this.dialogOpen.set(!0)}confirmDelete(){this.isUpdating.set(!0),this.deleteError.set(null),this.workerService.deleteWorker(this.worker().id).pipe(F(this.destroyRef)).subscribe(n=>{this.isUpdating.set(!1),n?(this.workerDeleted.emit(this.worker().id),this.closeDialog()):this.deleteError.set("delete_failed")})}getPerformanceUnit(){let n=this.worker(),l=parseFloat(n.performance);return isNaN(l)||l===0?null:n.type==="image"?this.unitConversion.formatWorkerPerformanceImage(l):n.type==="text"?this.unitConversion.formatWorkerPerformanceText(l):null}getMpsGeneratedUnit(){let n=this.worker();return n.type!=="image"||n.megapixelsteps_generated===void 0?null:this.unitConversion.formatWorkerMegapixelstepsGenerated(n.megapixelsteps_generated)}getTokensGeneratedUnit(){let n=this.worker();return n.type!=="text"||n.tokens_generated===void 0?null:this.unitConversion.formatWorkerTokensGenerated(n.tokens_generated)}};a.\u0275fac=function(l){return new(l||a)},a.\u0275cmp=X({type:a,selectors:[["app-worker-card"]],inputs:{worker:[1,"worker"],isModerator:[1,"isModerator"],viewMode:[1,"viewMode"]},outputs:{workerUpdated:"workerUpdated",workerDeleted:"workerDeleted"},decls:91,vars:68,consts:[[1,"toast","toast-success"],[1,"worker-modal-overlay"],[1,"p-4"],[1,"flex","items-start","justify-between"],[1,"flex","items-center","gap-3"],[1,"worker-status-icon","worker-status-icon-success",3,"title"],[1,"worker-status-icon","worker-status-icon-error",3,"title"],[1,"min-w-0"],[1,"flex","items-center","gap-2","mb-1"],[1,"heading-item","truncate",3,"title"],[1,"badge-base","badge-info"],[1,"badge-base","badge-success"],[1,"badge-base","badge-purple"],[1,"text-xs","text-secondary","truncate"],[1,"flex","items-center","gap-1","shrink-0"],[1,"p-1",3,"title"],[1,"p-4","text-sm","worker-card-section"],[1,"space-y-1","mb-3"],[1,"worker-card-row"],[1,"worker-card-label"],[1,"worker-link","truncate",3,"routerLink","title"],[1,"worker-card-value",3,"title"],[1,"flex","flex-col"],[1,"space-y-1","mb-3","pt-3","border-t","border-gray-200","dark:border-gray-700"],[1,"worker-card-value"],[1,"space-y-1","pt-3","border-t","border-gray-200","dark:border-gray-700"],[1,"mt-3","pt-3","worker-card-section"],[1,"px-4","py-3","worker-card-section","flex","gap-2"],[1,"worker-btn-models","text-sm",3,"click","title"],[1,"worker-btn-maintenance","text-sm",3,"title"],[1,"worker-btn-pause","text-sm",3,"title"],[1,"btn-danger","text-sm",3,"title"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 13l4 4L19 7"],[1,"modal-backdrop",3,"click"],[1,"worker-modal-panel","worker-modal-panel-large"],[1,"heading-card","mb-4"],[1,"text-secondary","text-sm","font-normal","ml-2"],[1,"text-secondary","text-sm"],[1,"flex","justify-end","mt-6"],[1,"worker-btn-models",3,"click"],[1,"mb-4"],["type","text",1,"form-input",3,"input","value","placeholder"],[1,"worker-modal-scroll"],[1,"worker-models-list"],[1,"worker-models-list-item"],[1,"flex","justify-end","gap-3"],[1,"worker-btn",3,"click"],[1,"worker-btn-maintenance",3,"click","disabled"],[1,"text-sm","text-secondary","mb-2","block"],["rows","3",1,"form-input",3,"input","value"],[1,"worker-btn-pause",3,"click","disabled"],[1,"mb-4","space-y-3"],[1,"p-3","rounded-lg","bg-red-100","dark:bg-red-900/30","border","border-red-300","dark:border-red-700"],[1,"text-sm","text-red-800","dark:text-red-200","font-medium"],[1,"p-3","rounded-lg","bg-amber-100","dark:bg-amber-900/30","border","border-amber-300","dark:border-amber-700"],[1,"text-sm","text-amber-800","dark:text-amber-200"],[1,"btn-danger",3,"click","disabled"],[1,"text-sm","text-red-800","dark:text-red-200"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","worker-indicator-yellow",2,"transform","scaleX(-1)"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 10V3L4 14h7v7l9-11h-7z"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","worker-indicator-yellow"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","worker-indicator-red"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3 21v-4m0 0V5a2 2 0 012-2h6.5l1 1H21l-3 6 3 6h-8.5l-1-1H5a2 2 0 00-2 2zm9-13.5V9"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","worker-indicator-green"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"],[1,"worker-card-value","truncate",3,"title"],[1,"worker-card-value","break-all"],[1,"worker-card-value","font-mono","text-xs"],[3,"unit","primaryOverride"],[1,"worker-card-value","break-words"],[1,"worker-card-label","text-xs","block","mb-2"],[1,"flex","flex-wrap","gap-1"],[1,"worker-badge"],[1,"space-y-2","max-h-24","overflow-y-auto"],[1,"worker-message"],[1,"worker-card-label","ml-1"],[1,"worker-btn-maintenance","text-sm",3,"click","title"],[1,"worker-btn-pause","text-sm",3,"click","title"],[1,"btn-danger","text-sm",3,"click","title"]],template:function(l,s){if(l&1&&(u(0,ce,6,3,"div",0),u(1,Te,7,1,"div",1),o(2,"div")(3,"div",2)(4,"div",3)(5,"div",4),u(6,We,4,3,"div",5)(7,Ie,4,3,"div",6),o(8,"div",7)(9,"div",8)(10,"h3",9),d(11),r(),u(12,Be,3,3,"span",10)(13,Me,3,3,"span",11)(14,Ve,3,3,"span",12),r(),o(15,"p",13),d(16),r()()(),o(17,"div",14),u(18,Ue,4,3,"div",15),u(19,De,4,3,"div",15),u(20,Fe,4,3,"div",15),u(21,Oe,4,3,"div",15),u(22,Pe,4,3,"div",15),u(23,$e,4,3,"div",15),r()()(),o(24,"div",16)(25,"div",17)(26,"div",18)(27,"span",19),d(28),p(29,"transloco"),r(),u(30,Le,2,5,"a",20)(31,je,2,2,"span",21),r(),u(32,Ge,6,5,"div",18),o(33,"div",22)(34,"span",19),d(35),p(36,"transloco"),r(),u(37,Re,2,3,"span",21)(38,Ae,2,2,"span",21),r(),u(39,Ne,6,4,"div",22),u(40,Ke,6,4,"div",22),u(41,He,6,4,"div",18),r(),o(42,"div",23)(43,"div",18)(44,"span",19),d(45),p(46,"transloco"),r(),o(47,"span",24),d(48),r()(),o(49,"div",18)(50,"span",19),d(51),p(52,"transloco"),r(),u(53,qe,3,3,"span",24)(54,ze,2,1,"span",24),r(),o(55,"div",18)(56,"span",19),d(57),p(58,"transloco"),r(),o(59,"span",24),d(60),r()(),o(61,"div",18)(62,"span",19),d(63),p(64,"transloco"),r(),o(65,"span",24),d(66),p(67,"formatNumber"),r()(),u(68,Qe,6,4,"div",18),u(69,et,6,4,"div",18),r(),o(70,"div",25),u(71,nt,2,1),u(72,ot,6,4,"div",18),o(73,"div",18)(74,"span",19),d(75),p(76,"transloco"),r(),o(77,"span",24),d(78),p(79,"transloco"),p(80,"transloco"),r()()(),u(81,ct,11,9,"div",26),u(82,ut,7,5,"div",26),r(),o(83,"div",27)(84,"button",28),p(85,"transloco"),w("click",function(){return s.openModelsDialog()}),d(86),p(87,"transloco"),r(),u(88,xt,4,4,"button",29),u(89,vt,5,6,"button",30),u(90,gt,4,6,"button",31),r()()),l&2){let f,V,U,G,R,A;C(s.showSuccess()?0:-1),i(),C(s.dialogOpen()?1:-1),i(),Q(s.getCardBackground()),i(4),C(s.hasIssue()?7:6),i(4),k("title",s.worker().name),i(),m(" ",s.truncateName(s.worker().name)," "),i(),C((f=s.worker().type)==="image"?12:f==="text"?13:f==="interrogation"?14:-1),i(4),x(s.worker().id),i(2),C(s.isLowSpeed()?18:-1),i(),C(s.isHighSpeed()?19:-1),i(),C(s.worker().paused?20:-1),i(),C(s.worker().maintenance_mode?21:-1),i(),C(s.worker().flagged?22:-1),i(),C(s.worker().trusted?23:-1),i(5),m("",c(29,44,"admin.workers.card.owner"),":"),i(2),C(s.getOwnerUserId()&&s.isModerator()?30:31),i(2),C(s.worker().team?32:-1),i(3),m("",c(36,46,"admin.workers.card.bridge_agent"),":"),i(2),C((V=s.getParsedBridgeAgent())?37:38,V),i(2),C((U=s.getParsedBridgeAgent())?39:-1,U),i(),C(s.worker().contact&&s.isModerator()?40:-1),i(),C(s.worker().ipaddr&&s.isModerator()?41:-1),i(4),m("",c(46,48,"admin.workers.card.uptime"),":"),i(3),x(s.formatUptime(s.worker().uptime)),i(3),m("",c(52,50,"admin.workers.card.speed"),":"),i(2),C((G=s.getPerformanceUnit())?53:54,G),i(4),m("",c(58,52,"admin.workers.card.threads"),":"),i(3),x(s.worker().threads),i(3),m("",c(64,54,"admin.workers.card.requests_fulfilled"),":"),i(3),x(c(67,56,s.worker().requests_fulfilled)),i(2),C(s.worker().type==="image"&&s.worker().megapixelsteps_generated!==void 0?68:-1),i(),C(s.worker().type==="text"&&s.worker().tokens_generated!==void 0?69:-1),i(2),C(s.worker().type!=="interrogation"?71:-1),i(),C(s.worker().type==="interrogation"&&(((R=s.worker().forms)==null?null:R.length)??0)>0?72:-1),i(3),m("",c(76,58,"admin.workers.card.nsfw"),":"),i(3),x(s.worker().nsfw?c(79,60,"admin.common.yes"):c(80,62,"admin.common.no")),i(3),C(s.worker().type==="image"&&s.hasImageCapabilities()?81:-1),i(),C((((A=s.worker().messages)==null?null:A.length)??0)>0&&s.isModerator()?82:-1),i(2),k("title",c(85,64,"admin.workers.action.show_models")),i(2),m(" ",c(87,66,"admin.workers.button.models")," "),i(2),C(s.canToggleMaintenance()?88:-1),i(),C(s.canTogglePause()?89:-1),i(),C(s.canDelete()?90:-1)}},dependencies:[te,ie,re,ee,ne],encapsulation:2,changeDetection:0});let e=a;return e})();export{ae as a,jt as b};
