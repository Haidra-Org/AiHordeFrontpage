<section class="section-primary">
  <div class="container-page-header">
    <div class="place-center">
      <h1 class="heading-hero">
        {{ "frequently_asked_questions" | transloco }}
      </h1>
      <p class="text-description mt-4 max-w-2xl">
        {{ "faq_subtitle" | transloco }}
      </p>
    </div>
  </div>
</section>

@if (faq()) {
  <section class="section-secondary">
    <div class="container-content">
      <div class="max-w-4xl mx-auto">
        @for (
          sectionItemPair of faq()! | keyvalue: NoSorterKeyValue;
          track sectionItemPair
        ) {
          <div style="position: relative; padding-bottom: 1rem">
            @if (sectionItemPair.key !== "") {
              <h2
                class="heading-section section-header-collapsible"
                (click)="toggleSection(sectionItemPair.key)"
              >
                <span>{{ sectionItemPair.key }}</span>
                <svg
                  class="chevron-icon"
                  [class.expanded]="!isSectionCollapsed(sectionItemPair.key)"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M19 9l-7 7-7-7"
                  />
                </svg>
              </h2>
            }

            @if (!isSectionCollapsed(sectionItemPair.key)) {
              <div class="space-y-0">
                @for (faqItem of sectionItemPair.value; track faqItem.question) {
                  <div>
                    <h3>
                      <button
                        type="button"
                        [class.is-active]="selectedFaq() === faqItem.question"
                        class="faq-question"
                        [attr.aria-expanded]="selectedFaq() === faqItem.question"
                        [attr.aria-controls]="'faq-answer-' + faqItem.question"
                        (click)="
                          selectedFaq.set(
                            selectedFaq() === faqItem.question
                              ? null
                              : faqItem.question
                          )
                        "
                      >
                        <span class="text-left pr-4">{{ faqItem.question }}</span>
                        <inline-svg
                          href="assets/img/faq-closed.svg"
                          class="faq-chevron"
                        />
                      </button>
                    </h3>
                    @if (selectedFaq() === faqItem.question) {
                      <div
                        class="faq-answer"
                        [id]="'faq-answer-' + faqItem.question"
                        role="region"
                      >
                        <div class="prose-content" [innerHTML]="faqItem.answer"></div>
                      </div>
                    }
                  </div>
                }
              </div>
            }
          </div>
        }
      </div>
    </div>
  </section>
}
