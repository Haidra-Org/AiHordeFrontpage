import{a as me}from"./chunk-2DGCEA46.js";import{a as Re}from"./chunk-SGVKRTY7.js";import{a as qe,b as ue,d as Oe}from"./chunk-G2WW7QSD.js";import{a as Ve,b as Le}from"./chunk-55UZNR6J.js";import{a as Fe}from"./chunk-E6WC5BTC.js";import{a as He}from"./chunk-3QN7C5B4.js";import{a as $e,b as We}from"./chunk-SSLEQYO6.js";import{c as oe,d as K,e as ae,f as re,g as le,h as L,i as se,j as De,k as de,l as pe,n as Me,o as Ae,r as Ne,u as ce}from"./chunk-DQEJQ2UN.js";import{a as _e}from"./chunk-HM33CXRW.js";import{a as Ue}from"./chunk-VYNBQZBJ.js";import{c as A,d as Pe}from"./chunk-65WGSKXW.js";import{a as O}from"./chunk-HAOFLEYL.js";import"./chunk-HLFKHDP3.js";import{d as Ke,e as ne}from"./chunk-PSNERGXC.js";import"./chunk-LYJSE2CR.js";import{k as Be}from"./chunk-J34MUKJJ.js";import{g as Ie,k as P}from"./chunk-JIQRQOFL.js";import{A as $,Cb as b,Db as _,F as he,Hb as ke,Ib as Se,Jb as Ee,Oa as i,Ob as U,Pb as we,Rb as s,S as be,Sb as f,Tb as m,X as w,Za as D,aa as g,ac as te,ba as v,ca as H,da as ee,dc as p,ec as c,fc as ie,ga as W,j as ye,ja as S,k as J,kc as E,l as z,lc as Te,nb as B,nc as M,ob as u,oc as I,pb as x,q as N,r as ge,rb as q,s as ve,sb as R,tb as y,ub as r,vb as a,w as X,wb as k,zb as T}from"./chunk-7X6QMTFM.js";import{a as j,b as G}from"./chunk-4CLCTAJ7.js";var je=(()=>{let d=class d{constructor(){this.httpClient=w(Ie),this.auth=w(O),this.baseUrl="https://aihorde.net/api/v2/sharedkeys",this.clientAgent="AiHordeFrontpage:login",this.handleError=t=>{let o={status:t.status??0,message:t.error?.message??"Unexpected error while contacting the API.",rc:t.error?.rc};return z(()=>o)}}buildHeaders(t){let o={"Client-Agent":this.clientAgent};return t&&(o.apikey=t),o}ensureApiKey(){return this.auth.getStoredApiKey()}getSharedKey(t){let o=this.ensureApiKey();return this.httpClient.get(`${this.baseUrl}/${t}`,{headers:this.buildHeaders(o??void 0)}).pipe($(this.handleError))}getSharedKeysByIds(t){return t.length===0?J([]):X(t.map(o=>this.getSharedKey(o))).pipe(N(o=>o.filter(l=>!!l)))}createSharedKey(t){let o=this.ensureApiKey();return o?this.httpClient.put(`${this.baseUrl}`,t,{headers:this.buildHeaders(o)}).pipe($(this.handleError)):z(()=>({status:401,message:"Missing API key. Please log in again to manage shared keys."}))}updateSharedKey(t,o){let l=this.ensureApiKey();return l?this.httpClient.patch(`${this.baseUrl}/${t}`,o,{headers:this.buildHeaders(l)}).pipe($(this.handleError)):z(()=>({status:401,message:"Missing API key. Please log in again to manage shared keys."}))}deleteSharedKey(t){let o=this.ensureApiKey();return o?this.httpClient.delete(`${this.baseUrl}/${t}`,{headers:this.buildHeaders(o)}).pipe(N(()=>!0),$(this.handleError)):z(()=>({status:401,message:"Missing API key. Please log in again to manage shared keys."}))}};d.\u0275fac=function(o){return new(o||d)},d.\u0275prov=be({token:d,factory:d.\u0275fac,providedIn:"root"});let e=d;return e})();var Q=["kudos","expiry","max_image_pixels","max_image_steps","max_text_tokens"],F={name:"",kudos:5e3,kudos_unlimited:!1,expiry:-1,expiry_unlimited:!0,max_image_pixels:-1,max_image_pixels_unlimited:!0,max_image_steps:-1,max_image_steps_unlimited:!0,max_text_tokens:-1,max_text_tokens_unlimited:!0},xe={kudos:5e3,expiry:30,max_image_pixels:1048576,max_image_steps:30,max_text_tokens:256},Ge=[{label:"512 x 512",value:262144},{label:"768 x 768",value:589824},{label:"1024 x 1024",value:1048576}];var Xe=(e,d)=>d.value;function et(e,d){e&1&&(r(0,"span",6),s(1),p(2,"transloco"),a()),e&2&&(i(),f(c(2,1,"profile.shared_keys.unlimited")))}function tt(e,d){e&1&&(r(0,"span",6),s(1),p(2,"transloco"),a()),e&2&&(i(),f(c(2,1,"profile.shared_keys.unlimited")))}function it(e,d){if(e&1&&(r(0,"p",11),s(1),a()),e&2){let n=_();i(),m(" ~ ",n.squareDimensionFromPixels(n.getMaxImagePixelsValue())," px ")}}function nt(e,d){e&1&&(r(0,"span",6),s(1),p(2,"transloco"),a()),e&2&&(i(),f(c(2,1,"profile.shared_keys.unlimited")))}function ot(e,d){if(e&1){let n=T();r(0,"button",24),b("click",function(){let o=g(n).$implicit,l=_();return v(l.applyImagePixelsPreset(o.value))}),s(1),a()}if(e&2){let n=d.$implicit;i(),m(" ",n.label," ")}}function at(e,d){e&1&&(r(0,"span",6),s(1),p(2,"transloco"),a()),e&2&&(i(),f(c(2,1,"profile.shared_keys.unlimited")))}function rt(e,d){e&1&&(r(0,"span",6),s(1),p(2,"transloco"),a()),e&2&&(i(),f(c(2,1,"profile.shared_keys.unlimited")))}function lt(e,d){if(e&1){let n=T();r(0,"button",25),b("click",function(){g(n);let o=_();return v(o.onCancel())}),s(1),a()}if(e&2){let n=_();y("disabled",n.submitting()),i(),m(" ",n.cancelLabel()," ")}}function st(e,d){if(e&1&&s(0),e&2){let n=_();m(" ",n.submittingLabel()," ")}}function dt(e,d){if(e&1&&s(0),e&2){let n=_();m(" ",n.submitLabel()," ")}}var fe=(()=>{let d=class d{constructor(){this.destroyRef=w(W),this.initialValues=I(F),this.submitLabel=I("Save"),this.submittingLabel=I("Saving..."),this.submitting=I(!1),this.showCancel=I(!1),this.cancelLabel=I("Cancel"),this.formSubmit=M(),this.formCancel=M(),this.form=this.createForm(F),this.imagePixelPresets=Ge,this.finiteCache=this.createFiniteCache(F),Te(()=>{let t=this.initialValues();this.applyFormValues(t)})}ngOnInit(){this.linkUnlimitedControls()}squareDimensionFromPixels(t){if(t==null||t<=0)return null;let o=Math.round(Math.sqrt(t));return`${o} x ${o}`}applyImagePixelsPreset(t){let o=this.form.controls.max_image_pixels,l=this.form.controls.max_image_pixels_unlimited,h={emitEvent:!1};l.setValue(!1,h),o.enable(h),o.setValue(t,h),this.finiteCache.max_image_pixels=t,o.markAsDirty(),o.markAsTouched(),l.markAsDirty(),l.markAsTouched(),this.form.updateValueAndValidity()}onSubmit(){if(!this.form.valid)return;let t=this.buildPayload();this.formSubmit.emit(t)}onCancel(){this.formCancel.emit()}getMaxImagePixelsValue(){return this.form.controls.max_image_pixels.getRawValue()}isUnlimited(t){return this.form.controls[`${t}_unlimited`]?.value??!1}createForm(t){return new le({name:new L(t.name,{nonNullable:!0,validators:[K.required,K.minLength(3),K.maxLength(255)]}),kudos:new L(t.kudos,{nonNullable:!0,validators:[K.required,K.min(-1),K.max(5e7)]}),kudos_unlimited:new L(t.kudos_unlimited,{nonNullable:!0}),expiry:new L(t.expiry,{nonNullable:!0,validators:[K.required,K.min(-1)]}),expiry_unlimited:new L(t.expiry_unlimited,{nonNullable:!0}),max_image_pixels:new L(t.max_image_pixels,{nonNullable:!0,validators:[K.required,K.min(-1),K.max(4194304)]}),max_image_pixels_unlimited:new L(t.max_image_pixels_unlimited,{nonNullable:!0}),max_image_steps:new L(t.max_image_steps,{nonNullable:!0,validators:[K.required,K.min(-1),K.max(500)]}),max_image_steps_unlimited:new L(t.max_image_steps_unlimited,{nonNullable:!0}),max_text_tokens:new L(t.max_text_tokens,{nonNullable:!0,validators:[K.required,K.min(-1),K.max(500)]}),max_text_tokens_unlimited:new L(t.max_text_tokens_unlimited,{nonNullable:!0})})}createFiniteCache(t){return Q.reduce((o,l)=>{let h=t[l];return o[l]=h!==-1?h:xe[l],o},{})}seedFiniteCacheFromValues(t){Q.forEach(o=>{let l=t[o];this.finiteCache[o]=l!==-1?l:this.finiteCache[o]??xe[o]})}applyUnlimitedState(t,o){let l=this.form.controls[t],h={emitEvent:!1};if(o){let C=l.getRawValue();typeof C=="number"&&C!==-1&&(this.finiteCache[t]=C),l.disable(h),l.setValue(-1,h)}else{let C=this.finiteCache[t]??xe[t];l.enable(h),l.setValue(C,h)}}refreshUnlimitedStates(){Q.forEach(t=>{let o=this.form.controls[`${t}_unlimited`];this.applyUnlimitedState(t,!!o.value)})}linkUnlimitedControls(){Q.forEach(t=>{let o=this.form.controls[t],l=this.form.controls[`${t}_unlimited`];this.applyUnlimitedState(t,!!l.value),l.valueChanges.pipe(P(this.destroyRef)).subscribe(h=>this.applyUnlimitedState(t,!!h)),o.valueChanges.pipe(P(this.destroyRef)).subscribe(h=>{o.disabled||typeof h=="number"&&h!==-1&&(this.finiteCache[t]=h)})})}applyFormValues(t){this.form.enable({emitEvent:!1}),this.form.setValue(t,{emitEvent:!1}),this.seedFiniteCacheFromValues(t),this.refreshUnlimitedStates(),this.form.markAsPristine(),this.form.markAsUntouched()}buildPayload(){let t=this.form.getRawValue();return{name:t.name.trim(),kudos:Number(t.kudos),expiry:Number(t.expiry),max_image_pixels:Number(t.max_image_pixels),max_image_steps:Number(t.max_image_steps),max_text_tokens:Number(t.max_text_tokens)}}};d.\u0275fac=function(o){return new(o||d)},d.\u0275cmp=D({type:d,selectors:[["app-shared-key-form"]],inputs:{initialValues:[1,"initialValues"],submitLabel:[1,"submitLabel"],submittingLabel:[1,"submittingLabel"],submitting:[1,"submitting"],showCancel:[1,"showCancel"],cancelLabel:[1,"cancelLabel"]},outputs:{formSubmit:"formSubmit",formCancel:"formCancel"},decls:68,vars:54,consts:[[1,"shared-key-form",3,"ngSubmit","formGroup"],[1,"shared-key-form-grid"],[1,"form-label"],["type","text","formControlName","name",1,"form-input",3,"placeholder"],[1,"form-field-container"],["type","number","formControlName","kudos","aria-describedby","shared-key-kudos-hint",1,"form-input"],[1,"form-input-unlimited-overlay"],["formControlName","kudos_unlimited",3,"description"],["type","number","formControlName","expiry","aria-describedby","shared-key-expiry-hint",1,"form-input"],["formControlName","expiry_unlimited",3,"description"],["type","number","formControlName","max_image_pixels","aria-describedby","shared-key-limit-hint",1,"form-input"],[1,"square-dims-text","text-secondary","text-xs","mt-1"],["formControlName","max_image_pixels_unlimited",3,"description"],["aria-label","Quick pixel presets",1,"quick-fill-row"],["type","button",1,"btn-source-control","btn-xs"],["type","number","formControlName","max_image_steps","aria-describedby","shared-key-limit-hint",1,"form-input"],["formControlName","max_image_steps_unlimited",3,"description"],["type","number","formControlName","max_text_tokens","aria-describedby","shared-key-limit-hint",1,"form-input"],["formControlName","max_text_tokens_unlimited",3,"description"],["id","shared-key-limit-hint",1,"text-secondary","text-xs"],["id","shared-key-expiry-hint",1,"text-secondary","text-xs"],[1,"shared-key-actions","mt-3"],["type","button",1,"btn-source-control",3,"disabled"],["type","submit",1,"btn-primary",3,"disabled"],["type","button",1,"btn-source-control","btn-xs",3,"click"],["type","button",1,"btn-source-control",3,"click","disabled"]],template:function(o,l){o&1&&(r(0,"form",0),b("ngSubmit",function(){return l.onSubmit()}),r(1,"div",1)(2,"div")(3,"label",2),s(4),p(5,"transloco"),a(),k(6,"input",3),p(7,"transloco"),a(),r(8,"div")(9,"label",2),s(10),p(11,"transloco"),a(),r(12,"div",4),k(13,"input",5),u(14,et,3,3,"span",6),a(),k(15,"app-toggle-checkbox",7),p(16,"transloco"),a(),r(17,"div")(18,"label",2),s(19),p(20,"transloco"),a(),r(21,"div",4),k(22,"input",8),u(23,tt,3,3,"span",6),a(),k(24,"app-toggle-checkbox",9),p(25,"transloco"),a(),r(26,"div")(27,"label",2),s(28),p(29,"transloco"),a(),r(30,"div",4),k(31,"input",10),u(32,it,2,1,"p",11),u(33,nt,3,3,"span",6),a(),k(34,"app-toggle-checkbox",12),p(35,"transloco"),r(36,"div",13),q(37,ot,2,1,"button",14,Xe),a()(),r(39,"div")(40,"label",2),s(41),p(42,"transloco"),a(),r(43,"div",4),k(44,"input",15),u(45,at,3,3,"span",6),a(),k(46,"app-toggle-checkbox",16),p(47,"transloco"),a(),r(48,"div")(49,"label",2),s(50),p(51,"transloco"),a(),r(52,"div",4),k(53,"input",17),u(54,rt,3,3,"span",6),a(),k(55,"app-toggle-checkbox",18),p(56,"transloco"),a()(),r(57,"p",19),s(58),p(59,"transloco"),a(),r(60,"p",20),s(61),p(62,"transloco"),a(),r(63,"div",21),u(64,lt,2,2,"button",22),r(65,"button",23),u(66,st,1,1)(67,dt,1,1),a()()()),o&2&&(y("formGroup",l.form),i(4),f(c(5,26,"profile.shared_keys.name")),i(2),y("placeholder",c(7,28,"profile.shared_keys.name_placeholder")),i(4),f(c(11,30,"profile.shared_keys.kudos")),i(4),x(l.isUnlimited("kudos")?14:-1),i(),y("description",c(16,32,"profile.shared_keys.unlimited_checkbox")),i(4),f(c(20,34,"profile.shared_keys.expiry_days")),i(4),x(l.isUnlimited("expiry")?23:-1),i(),y("description",c(25,36,"profile.shared_keys.unlimited_checkbox")),i(4),f(c(29,38,"profile.shared_keys.max_image_pixels")),i(4),x(l.squareDimensionFromPixels(l.getMaxImagePixelsValue())?32:-1),i(),x(l.isUnlimited("max_image_pixels")?33:-1),i(),y("description",c(35,40,"profile.shared_keys.unlimited_checkbox")),i(3),R(l.imagePixelPresets),i(4),f(c(42,42,"profile.shared_keys.max_image_steps")),i(4),x(l.isUnlimited("max_image_steps")?45:-1),i(),y("description",c(47,44,"profile.shared_keys.unlimited_checkbox")),i(4),f(c(51,46,"profile.shared_keys.max_text_tokens")),i(4),x(l.isUnlimited("max_text_tokens")?54:-1),i(),y("description",c(56,48,"profile.shared_keys.unlimited_checkbox")),i(3),m(" ",c(59,50,"profile.shared_keys.limit_hint")," "),i(3),m(" ",c(62,52,"profile.shared_keys.expiry_hint")," "),i(3),x(l.showCancel()?64:-1),i(),U("btn-disabled",!l.form.valid||l.submitting()),y("disabled",!l.form.valid||l.submitting()),i(),x(l.submitting()?66:67))},dependencies:[ce,se,oe,De,ae,re,de,pe,A,me],styles:[".shared-key-form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:1rem}.quick-fill-row[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.5rem;margin-top:.5rem}.square-dims-text[_ngcontent-%COMP%]{font-style:italic;margin-bottom:.25rem}.btn-xs[_ngcontent-%COMP%]{padding:.3rem .55rem;font-size:.85rem}.shared-key-actions[_ngcontent-%COMP%]{display:flex;gap:.5rem;align-items:center;flex-wrap:wrap;justify-content:flex-end}"],changeDetection:0});let e=d;return e})();function pt(e,d){e&1&&(r(0,"span",4),s(1),p(2,"transloco"),a()),e&2&&(i(),f(c(2,1,"profile.shared_keys.status.active")))}function ct(e,d){e&1&&(r(0,"span",5),s(1),p(2,"transloco"),a()),e&2&&(i(),f(c(2,1,"profile.shared_keys.status.expired")))}function mt(e,d){e&1&&(r(0,"span",6),s(1),p(2,"transloco"),a()),e&2&&(i(),f(c(2,1,"profile.shared_keys.status.exhausted")))}function _t(e,d){e&1&&(s(0),p(1,"transloco")),e&2&&m(" ",c(1,1,"profile.shared_keys.unlimited")," ")}function ut(e,d){if(e&1&&(s(0),p(1,"formatNumber")),e&2){let n=_();m(" ",c(1,1,n.sharedKey().kudos??0)," ")}}function xt(e,d){if(e&1&&(r(0,"div",10)(1,"span",3),s(2),p(3,"transloco"),a(),r(4,"span",11),s(5),p(6,"formatNumber"),a()()),e&2){let n=_();i(2),f(c(3,2,"profile.shared_keys.utilized")),i(3),f(c(6,4,n.sharedKey().utilized??0))}}function ft(e,d){e&1&&(s(0),p(1,"transloco")),e&2&&m(" ",c(1,1,"profile.shared_keys.unlimited")," ")}function ht(e,d){if(e&1&&(s(0),p(1,"formatNumber")),e&2){let n=_();m(" ",c(1,1,n.sharedKey().max_image_pixels??0)," ")}}function Ct(e,d){if(e&1&&(r(0,"div",12),s(1),a()),e&2){let n=_();i(),m(" ~ ",n.squareDimensionFromPixels(n.sharedKey().max_image_pixels??null)," px ")}}function yt(e,d){e&1&&(s(0),p(1,"transloco")),e&2&&m(" ",c(1,1,"profile.shared_keys.unlimited")," ")}function gt(e,d){if(e&1&&(s(0),p(1,"formatNumber")),e&2){let n=_();m(" ",c(1,1,n.sharedKey().max_image_steps??0)," ")}}function vt(e,d){e&1&&(s(0),p(1,"transloco")),e&2&&m(" ",c(1,1,"profile.shared_keys.unlimited")," ")}function bt(e,d){if(e&1&&(s(0),p(1,"formatNumber")),e&2){let n=_();m(" ",c(1,1,n.sharedKey().max_text_tokens??0)," ")}}function kt(e,d){if(e&1&&s(0),e&2){let n=_();m(" ",n.formatExpiry(n.sharedKey().expiry)," ")}}function St(e,d){e&1&&(s(0),p(1,"transloco")),e&2&&m(" ",c(1,1,"profile.shared_keys.never")," ")}function Et(e,d){e&1&&(s(0),p(1,"transloco")),e&2&&m(" ",c(1,1,"profile.shared_keys.updating")," ")}function wt(e,d){e&1&&(s(0),p(1,"transloco")),e&2&&m(" ",c(1,1,"profile.shared_keys.edit")," ")}function Tt(e,d){e&1&&(s(0),p(1,"transloco")),e&2&&m(" ",c(1,1,"profile.shared_keys.deleting")," ")}function It(e,d){e&1&&(s(0),p(1,"transloco")),e&2&&m(" ",c(1,1,"profile.shared_keys.delete")," ")}function Bt(e,d){if(e&1){let n=T();r(0,"div",14)(1,"button",16),b("click",function(){g(n);let o=_();return v(o.startEdit())}),u(2,Et,2,3)(3,wt,2,3),a(),r(4,"button",17),b("click",function(){g(n);let o=_();return v(o.onDelete())}),u(5,Tt,2,3)(6,It,2,3),a()()}if(e&2){let n=_();i(),y("disabled",n.saving()),i(),x(n.saving()?2:3),i(2),y("disabled",n.deleting()),i(),x(n.deleting()?5:6)}}function Kt(e,d){if(e&1){let n=T();r(0,"app-shared-key-form",18),p(1,"transloco"),p(2,"transloco"),p(3,"transloco"),b("formSubmit",function(o){g(n);let l=_();return v(l.onFormSubmit(o))})("formCancel",function(){g(n);let o=_();return v(o.cancelEdit())}),a()}if(e&2){let n=_();y("initialValues",n.editFormValues())("submitLabel",c(1,6,"profile.shared_keys.save_changes"))("submittingLabel",c(2,8,"profile.shared_keys.updating"))("submitting",n.saving())("showCancel",!0)("cancelLabel",c(3,10,"profile.shared_keys.cancel"))}}var Ce=(()=>{let d=class d{constructor(){this.sharedKey=I.required(),this.saving=I(!1),this.deleting=I(!1),this.readonly=I(!1),this.update=M(),this.delete=M(),this.isEditing=S(!1),this.status=E(()=>{let t=this.sharedKey();return this.computeStatus(t)}),this.editFormValues=E(()=>{let t=this.sharedKey();return this.mapToFormValue(t)})}squareDimensionFromPixels(t){if(t==null||t<=0)return null;let o=Math.round(Math.sqrt(t));return`${o} x ${o}`}formatExpiry(t){if(!t)return"Never";let o=new Date(t);return Number.isNaN(o.getTime())?"Never":o.toLocaleString()}startEdit(){this.isEditing.set(!0)}cancelEdit(){this.isEditing.set(!1)}onFormSubmit(t){this.update.emit(t)}onDelete(){this.delete.emit()}closeEdit(){this.isEditing.set(!1)}computeStatus(t){if(t.expiry){let o=Date.parse(t.expiry);if(!Number.isNaN(o)&&o<Date.now())return"expired"}return t.kudos!==void 0&&t.kudos!==-1&&t.utilized!==void 0&&t.utilized>=t.kudos?"exhausted":"active"}mapToFormValue(t){let o=t.kudos??F.kudos,l=this.deriveExpiryDays(t.expiry),h=t.max_image_pixels??F.max_image_pixels,C=t.max_image_steps??F.max_image_steps,V=t.max_text_tokens??F.max_text_tokens;return{name:t.name??"",kudos:o,kudos_unlimited:o===-1,expiry:l,expiry_unlimited:l===-1,max_image_pixels:h,max_image_pixels_unlimited:h===-1,max_image_steps:C,max_image_steps_unlimited:C===-1,max_text_tokens:V,max_text_tokens_unlimited:V===-1}}deriveExpiryDays(t){if(!t)return-1;let o=Date.parse(t);if(Number.isNaN(o))return-1;let l=Math.ceil((o-Date.now())/(1e3*60*60*24));return l<0?-1:Math.max(l,1)}};d.\u0275fac=function(o){return new(o||d)},d.\u0275cmp=D({type:d,selectors:[["app-shared-key-card"]],inputs:{sharedKey:[1,"sharedKey"],saving:[1,"saving"],deleting:[1,"deleting"],readonly:[1,"readonly"]},outputs:{update:"update",delete:"delete"},decls:53,vars:29,consts:[[1,"shared-key-card"],[1,"shared-key-card__header"],[1,"shared-key-name-row"],[1,"data-label"],[1,"badge-base","badge-success"],[1,"badge-base","badge-warning"],[1,"badge-base","badge-danger"],[1,"shared-key-id"],[1,"shared-key-id-value"],[1,"shared-key-card__body"],[1,"shared-key-field"],[1,"data-value"],[1,"shared-key-dim-row","text-secondary","text-xs"],[1,"shared-key-card__footer"],[1,"shared-key-actions"],[3,"initialValues","submitLabel","submittingLabel","submitting","showCancel","cancelLabel"],["type","button",1,"btn-source-control",3,"click","disabled"],["type","button",1,"btn-danger",3,"click","disabled"],[3,"formSubmit","formCancel","initialValues","submitLabel","submittingLabel","submitting","showCancel","cancelLabel"]],template:function(o,l){o&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"p",3),s(4),p(5,"transloco"),a(),u(6,pt,3,3,"span",4)(7,ct,3,3,"span",5)(8,mt,3,3,"span",6),a(),r(9,"div",7)(10,"code",8),s(11),a()()(),r(12,"div",9)(13,"div",10)(14,"span",3),s(15),p(16,"transloco"),a(),r(17,"span",11),u(18,_t,2,3)(19,ut,2,3),a()(),u(20,xt,7,6,"div",10),r(21,"div",10)(22,"span",3),s(23),p(24,"transloco"),a(),r(25,"span",11),u(26,ft,2,3)(27,ht,2,3),a()(),u(28,Ct,2,1,"div",12),r(29,"div",10)(30,"span",3),s(31),p(32,"transloco"),a(),r(33,"span",11),u(34,yt,2,3)(35,gt,2,3),a()(),r(36,"div",10)(37,"span",3),s(38),p(39,"transloco"),a(),r(40,"span",11),u(41,vt,2,3)(42,bt,2,3),a()(),r(43,"div",10)(44,"span",3),s(45),p(46,"transloco"),a(),r(47,"span",11),u(48,kt,1,1)(49,St,2,3),a()()(),r(50,"div",13),u(51,Bt,7,4,"div",14),a(),u(52,Kt,4,12,"app-shared-key-form",15),a()),o&2&&(i(4),m(" ",l.sharedKey().name||c(5,17,"profile.shared_keys.untitled")," "),i(2),x(l.status()==="active"?6:l.status()==="expired"?7:l.status()==="exhausted"?8:-1),i(5),f(l.sharedKey().id),i(4),f(c(16,19,"profile.shared_keys.kudos")),i(3),x(l.sharedKey().kudos===-1?18:19),i(2),x(l.sharedKey().utilized!==void 0?20:-1),i(3),f(c(24,21,"profile.shared_keys.max_image_pixels")),i(3),x(l.sharedKey().max_image_pixels===-1?26:27),i(2),x(l.sharedKey().max_image_pixels!==-1&&l.squareDimensionFromPixels(l.sharedKey().max_image_pixels??null)?28:-1),i(3),f(c(32,23,"profile.shared_keys.max_image_steps")),i(3),x(l.sharedKey().max_image_steps===-1?34:35),i(4),f(c(39,25,"profile.shared_keys.max_text_tokens")),i(3),x(l.sharedKey().max_text_tokens===-1?41:42),i(4),f(c(46,27,"profile.shared_keys.expires")),i(3),x(l.sharedKey().expiry?48:49),i(3),x(l.readonly()?-1:51),i(),x(l.isEditing()&&!l.readonly()?52:-1))},dependencies:[A,_e,fe],styles:[".shared-key-card[_ngcontent-%COMP%]{border:1px solid rgba(255,255,255,.08);background:#ffffff0a;border-radius:.75rem;padding:.75rem}.shared-key-card__header[_ngcontent-%COMP%]{margin-bottom:.75rem}.shared-key-name-row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;flex-wrap:wrap}.shared-key-id[_ngcontent-%COMP%]{margin-top:.5rem}.shared-key-id-value[_ngcontent-%COMP%]{display:block;background:#6366f126;border:1px solid rgba(99,102,241,.3);color:#a5b4fc;padding:.375rem .75rem;border-radius:.375rem;font-family:Courier New,monospace;font-size:.875rem;font-weight:600;word-break:break-all;-webkit-user-select:all;user-select:all;width:100%}.shared-key-card__body[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:.5rem 1rem;margin-top:.75rem}.shared-key-field[_ngcontent-%COMP%]{display:flex;justify-content:space-between;gap:.5rem}.shared-key-dim-row[_ngcontent-%COMP%]{text-align:right}.shared-key-card__footer[_ngcontent-%COMP%]{margin-top:1rem;border-top:1px solid rgba(255,255,255,.08);padding-top:1rem}.shared-key-actions[_ngcontent-%COMP%]{display:flex;gap:.5rem;align-items:center;flex-wrap:wrap;justify-content:flex-end}"],changeDetection:0});let e=d;return e})();var Pt=(e,d)=>d.id;function Vt(e,d){e&1&&(s(0),p(1,"transloco")),e&2&&m(" ",c(1,1,"profile.shared_keys.loading")," ")}function Lt(e,d){e&1&&(s(0),p(1,"transloco")),e&2&&m(" ",c(1,1,"profile.shared_keys.refresh")," ")}function Ut(e,d){if(e&1){let n=T();r(0,"button",10),b("click",function(){g(n);let o=_(2);return v(o.loadSharedKeys())}),u(1,Vt,2,3)(2,Lt,2,3),a()}if(e&2){let n=_(2);y("disabled",n.loading()),i(),x(n.loading()?1:2)}}function Ft(e,d){if(e&1&&(r(0,"div",1)(1,"div")(2,"h3",6),s(3),p(4,"transloco"),a(),r(5,"p",7),s(6),p(7,"transloco"),a(),r(8,"p",8),s(9),p(10,"transloco"),a()(),u(11,Ut,3,2,"button",9),a()),e&2){let n=_();i(3),m(" ",c(4,4,"profile.tabs.shared_keys")," "),i(3),m(" ",c(7,6,"profile.shared_keys.description")," "),i(3),m(" ",c(10,8,"profile.shared_keys.cache_notice")," "),i(2),x(n.isExternalData()?-1:11)}}function Dt(e,d){if(e&1&&(r(0,"div",2)(1,"p",11),s(2),p(3,"transloco"),a(),r(4,"p",12),s(5),a()()),e&2){let n=_();i(2),m(" ",c(3,2,"profile.shared_keys.error_title")," "),i(3),f(n.error())}}function Mt(e,d){if(e&1&&(r(0,"div",3)(1,"p",11),s(2),p(3,"transloco"),a(),r(4,"p",12),s(5),a()()),e&2){let n=_();i(2),m(" ",c(3,2,"profile.shared_keys.success_title")," "),i(3),f(n.success())}}function At(e,d){e&1&&(r(0,"p",4),s(1),p(2,"transloco"),a()),e&2&&(i(),m(" ",c(2,1,"profile.shared_keys.loading")," "))}function Nt(e,d){e&1&&(r(0,"p",4),s(1),p(2,"transloco"),a()),e&2&&(i(),m(" ",c(2,1,"profile.shared_keys.none")," "))}function $t(e,d){if(e&1){let n=T();r(0,"app-shared-key-card",15),b("update",function(o){let l=g(n).$implicit,h=_(3);return v(h.onUpdate(l.id,o))})("delete",function(){let o=g(n).$implicit,l=_(3);return v(l.onDelete(o.id))}),a()}if(e&2){let n=d.$implicit,t=_(3);y("sharedKey",n)("saving",t.isSaving(n.id))("deleting",t.isDeleting(n.id))("readonly",t.readonly())}}function Wt(e,d){if(e&1&&(r(0,"div",13),q(1,$t,1,4,"app-shared-key-card",14,Pt),a()),e&2){let n=_(2);i(),R(n.sharedKeys())}}function qt(e,d){if(e&1&&u(0,Nt,3,3,"p",4)(1,Wt,3,0,"div",13),e&2){let n=_();x(n.sharedKeys().length===0?0:1)}}function Rt(e,d){if(e&1){let n=T();r(0,"button",17),b("click",function(){g(n);let o=_(2);return v(o.toggleCreateForm())}),s(1),p(2,"transloco"),a()}e&2&&(i(),m(" ",c(2,1,"profile.shared_keys.create_title")," "))}function Ot(e,d){if(e&1){let n=T();r(0,"h4",18),s(1),p(2,"transloco"),a(),r(3,"app-shared-key-form",19),p(4,"transloco"),p(5,"transloco"),b("formSubmit",function(o){g(n);let l=_(2);return v(l.onCreateSubmit(o))}),a(),r(6,"button",20),b("click",function(){g(n);let o=_(2);return v(o.toggleCreateForm())}),s(7),p(8,"transloco"),a()}if(e&2){let n=_(2);i(),m(" ",c(2,6,"profile.shared_keys.create_title")," "),i(2),y("initialValues",n.createFormDefaults)("submitLabel",c(4,8,"profile.shared_keys.create"))("submittingLabel",c(5,10,"profile.shared_keys.creating"))("submitting",n.creating()),i(4),m(" ",c(8,12,"profile.shared_keys.cancel")," ")}}function Ht(e,d){if(e&1&&(r(0,"div",5),u(1,Rt,3,3,"button",16)(2,Ot,9,14),a()),e&2){let n=_();i(),x(n.createFormCollapsed()?1:2)}}var ze=(()=>{let d=class d{constructor(){this.destroyRef=w(W),this.sharedKeyService=w(je),this.auth=w(O),this.externalSharedKeys=I(void 0,{alias:"sharedKeys"}),this.externalLoading=I(!1,{alias:"loadingExternal"}),this.readonly=I(!1),this.showHeader=I(!0),this.sharedKeysChange=M(),this.internalSharedKeys=S([]),this.sharedKeys=E(()=>{let t=this.externalSharedKeys();return t!==void 0?t:this.internalSharedKeys()}),this.isExternalData=E(()=>this.externalSharedKeys()!==void 0),this.internalLoading=S(!1),this.loading=E(()=>this.isExternalData()?this.externalLoading():this.internalLoading()),this.error=S(null),this.success=S(null),this.creating=S(!1),this.savingKeyId=S(null),this.deletingKeyId=S(null),this.createFormDefaults=F,this.createFormCollapsed=S(!0)}ngOnInit(){this.isExternalData()||this.loadSharedKeys()}loadSharedKeys(){if(this.isExternalData())return;let t=this.auth.currentUser()?.sharedkey_ids??[];if(this.internalLoading.set(!0),this.error.set(null),t.length===0){this.internalSharedKeys.set([]),this.internalLoading.set(!1);return}this.sharedKeyService.getSharedKeysByIds(t).pipe(P(this.destroyRef)).subscribe({next:o=>{this.internalSharedKeys.set(o)},error:o=>{let l=this.extractError(o);this.error.set(l),this.internalLoading.set(!1)},complete:()=>{this.internalLoading.set(!1)}})}onCreateSubmit(t){this.readonly()||(this.creating.set(!0),this.error.set(null),this.success.set(null),this.sharedKeyService.createSharedKey(t).pipe(P(this.destroyRef)).subscribe({next:o=>{let l=[...this.sharedKeys(),o];this.internalSharedKeys.set(l),this.sharedKeysChange.emit(l),this.success.set("Shared key created. Changes can take up to 5 minutes to propagate due to caching.")},error:o=>{this.error.set(this.extractError(o)),this.creating.set(!1)},complete:()=>{this.creating.set(!1)}}))}onUpdate(t,o){this.readonly()||(this.savingKeyId.set(t),this.error.set(null),this.success.set(null),this.sharedKeyService.updateSharedKey(t,o).pipe(P(this.destroyRef)).subscribe({next:l=>{let h=this.sharedKeys().map(C=>C.id===l.id?l:C);this.internalSharedKeys.set(h),this.sharedKeysChange.emit(h),this.success.set("Shared key updated. Changes can take up to 5 minutes to propagate due to caching."),this.closeCardEdit(t)},error:l=>{this.error.set(this.extractError(l)),this.savingKeyId.set(null)},complete:()=>{this.savingKeyId.set(null)}}))}onDelete(t){this.readonly()||(this.deletingKeyId.set(t),this.error.set(null),this.success.set(null),this.sharedKeyService.deleteSharedKey(t).pipe(P(this.destroyRef)).subscribe({next:()=>{let o=this.sharedKeys().filter(l=>l.id!==t);this.internalSharedKeys.set(o),this.sharedKeysChange.emit(o),this.success.set("Shared key deleted. Changes can take up to 5 minutes to propagate due to caching.")},error:o=>{this.error.set(this.extractError(o)),this.deletingKeyId.set(null)},complete:()=>{this.deletingKeyId.set(null)}}))}isSaving(t){return this.savingKeyId()===t}isDeleting(t){return this.deletingKeyId()===t}toggleCreateForm(){this.createFormCollapsed.update(t=>!t)}closeCardEdit(t){this.cardComponents?.find(l=>l.sharedKey().id===t)?.closeEdit()}extractError(t){if(t&&typeof t=="object"){let o=t,l=o.rc?` (code: ${o.rc})`:"",h=o.status?` [${o.status}]`:"";if(o.message)return`${o.message}${h}${l}`}return"Something went wrong while communicating with the API."}};d.\u0275fac=function(o){return new(o||d)},d.\u0275cmp=D({type:d,selectors:[["app-shared-key-list"]],viewQuery:function(o,l){if(o&1&&ke(Ce,5),o&2){let h;Se(h=Ee())&&(l.cardComponents=h)}},inputs:{externalSharedKeys:[1,"sharedKeys","externalSharedKeys"],externalLoading:[1,"loadingExternal","externalLoading"],readonly:[1,"readonly"],showHeader:[1,"showHeader"]},outputs:{sharedKeysChange:"sharedKeysChange"},decls:7,vars:5,consts:[[1,"shared-keys-container"],[1,"shared-keys-header"],["role","alert",1,"alert","alert-error"],["role","status",1,"alert","alert-success"],[1,"text-secondary","text-sm","py-4"],[1,"section-divider-top"],[1,"heading-card"],[1,"text-secondary","text-sm"],[1,"text-secondary","text-xs","mt-1"],["type","button",1,"btn-source-control",3,"disabled"],["type","button",1,"btn-source-control",3,"click","disabled"],[1,"alert-title"],[1,"alert-body"],[1,"shared-key-grid"],[3,"sharedKey","saving","deleting","readonly"],[3,"update","delete","sharedKey","saving","deleting","readonly"],["type","button",1,"btn-primary","w-full"],["type","button",1,"btn-primary","w-full",3,"click"],[1,"section-title-sm","mb-2"],[3,"formSubmit","initialValues","submitLabel","submittingLabel","submitting"],["type","button",1,"btn-secondary","mt-3",3,"click"]],template:function(o,l){o&1&&(r(0,"div",0),u(1,Ft,12,10,"div",1),u(2,Dt,6,4,"div",2),u(3,Mt,6,4,"div",3),u(4,At,3,3,"p",4)(5,qt,2,1),u(6,Ht,3,1,"div",5),a()),o&2&&(i(),x(l.showHeader()?1:-1),i(),x(l.error()?2:-1),i(),x(l.success()?3:-1),i(),x(l.loading()?4:5),i(2),x(l.readonly()?-1:6))},dependencies:[A,Ce,fe],styles:[".shared-keys-container[_ngcontent-%COMP%]{width:100%}.shared-keys-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;gap:1rem;flex-wrap:wrap}.shared-key-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:1rem;margin-top:1rem}.alert[_ngcontent-%COMP%]{border-radius:.75rem;padding:.75rem 1rem;border:1px solid;margin-top:1rem}.alert-error[_ngcontent-%COMP%]{background:#be185d1f;border-color:#be185d99;color:#f87171}.alert-success[_ngcontent-%COMP%]{background:#10b9811f;border-color:#10b98199;color:#6ee7b7}.alert-title[_ngcontent-%COMP%]{font-weight:600;margin-bottom:.25rem}.alert-body[_ngcontent-%COMP%]{margin:0}"],changeDetection:0});let e=d;return e})();var jt=(e,d)=>d.id;function Gt(e,d){if(e&1&&(r(0,"span",5),s(1),a()),e&2){let n=_();i(),m("(",n.imageCount(),")")}}function zt(e,d){if(e&1&&(r(0,"span",5),s(1),a()),e&2){let n=_();i(),m("(",n.textCount(),")")}}function Zt(e,d){if(e&1){let n=T();r(0,"button",12),b("click",function(){g(n);let o=_();return v(o.openCreateForm())}),H(),r(1,"svg",3),k(2,"path",13),a(),s(3),p(4,"transloco"),a()}if(e&2){let n=_();y("disabled",n.showCreateForm()),i(3),m(" ",c(4,2,"styles.create")," ")}}function Qt(e,d){if(e&1){let n=T();r(0,"div",8)(1,"app-style-form",14),b("formSubmit",function(o){g(n);let l=_();return v(l.onCreateStyle(o))})("formCancel",function(){g(n);let o=_();return v(o.closeCreateForm())}),a()()}if(e&2){let n=_();i(),y("mode","create")("styleType",n.currentStyleType())("saving",n.creating())}}function Yt(e,d){if(e&1){let n=T();r(0,"div",9),H(),r(1,"svg",15),k(2,"path",16),a(),ee(),r(3,"p"),s(4),a(),r(5,"button",17),b("click",function(){g(n);let o=_();return v(o.loadUserStyles())}),s(6),p(7,"transloco"),a()()}if(e&2){let n=_();i(4),f(n.error()),i(2),m(" ",c(7,2,"styles.retry")," ")}}function Jt(e,d){e&1&&(r(0,"div",10),k(1,"div",18),r(2,"p"),s(3),p(4,"transloco"),a()()),e&2&&(i(3),f(c(4,1,"profile.styles.loading")))}function Xt(e,d){e&1&&(r(0,"div",19),H(),r(1,"svg",21),k(2,"path",22),a(),ee(),r(3,"p"),s(4),p(5,"transloco"),a(),r(6,"p",5),s(7),p(8,"transloco"),a()()),e&2&&(i(4),f(c(5,2,"profile.styles.no_styles")),i(3),m(" ",c(8,4,"profile.styles.create_hint")," "))}function ei(e,d){if(e&1){let n=T();r(0,"app-style-card",24),b("navigate",function(){let o=g(n).$implicit,l=_(3);return v(l.navigateToStyle(o))})("edit",function(){let o=g(n).$implicit,l=_(3);return v(l.onEditStyle(o))})("delete",function(){let o=g(n).$implicit,l=_(3);return v(l.onDeleteStyle(o))}),a()}if(e&2){let n=d.$implicit,t=_(3);we(n),y("styleType",t.activeTab())("showActions",!t.readonly())}}function ti(e,d){if(e&1&&(r(0,"div",20),q(1,ei,1,4,"app-style-card",23,jt),a()),e&2){let n=_(2);i(),R(n.filteredStyles())}}function ii(e,d){if(e&1&&u(0,Xt,9,6,"div",19)(1,ti,3,0,"div",20),e&2){let n=_();x(n.filteredStyles().length===0?0:1)}}function ni(e,d){e&1&&(r(0,"div",11)(1,"a",25),H(),r(2,"svg",3),k(3,"path",26),a(),s(4),p(5,"transloco"),a()()),e&2&&(i(4),m(" ",c(5,1,"profile.styles.browse_all")," "))}var Ze=(()=>{let d=class d{constructor(){this.styleService=w(qe),this.auth=w(O),this.router=w(Ke),this.destroyRef=w(W),this.externalStyles=I(void 0,{alias:"styles"}),this.externalLoading=I(!1,{alias:"loadingExternal"}),this.readonly=I(!1),this.compact=I(!1),this.stylesChange=M(),this.activeTab=S("image"),this.internalLoading=S(!1),this.loading=E(()=>this.isExternalData()?this.externalLoading():this.internalLoading()),this.error=S(null),this.internalUserStyles=S([]),this.userStyles=E(()=>{let t=this.externalStyles();return t!==void 0?t:this.internalUserStyles()}),this.isExternalData=E(()=>this.externalStyles()!==void 0),this.showCreateForm=S(!1),this.creating=S(!1),this.currentUser=E(()=>this.auth.currentUser()),this.userStyleIds=E(()=>this.currentUser()?.styles??[]),this.imageStyles=E(()=>this.userStyles().filter(t=>t.type==="image"&&t.style).map(t=>t.style)),this.textStyles=E(()=>this.userStyles().filter(t=>t.type==="text"&&t.style).map(t=>t.style)),this.filteredStyles=E(()=>this.activeTab()==="image"?this.imageStyles():this.textStyles()),this.imageCount=E(()=>this.userStyles().filter(t=>t.type==="image").length),this.textCount=E(()=>this.userStyles().filter(t=>t.type==="text").length),this.currentStyleType=E(()=>this.activeTab()==="text"?"text":"image")}ngOnInit(){this.isExternalData()||this.loadUserStyles()}setActiveTab(t){this.activeTab()!==t&&(this.activeTab.set(t),this.showCreateForm.set(!1))}loadUserStyles(){if(this.isExternalData())return;let t=this.userStyleIds();if(!t||t.length===0){this.internalUserStyles.set([]);return}this.internalLoading.set(!0),this.error.set(null),this.internalUserStyles.set(t.map(l=>({id:l,style:null,type:null,loading:!0,error:!1})));let o=t.map(l=>this.styleService.getImageStyle(l).pipe(N(h=>({style:h,type:"image"})),$(()=>this.styleService.getTextStyle(l).pipe(N(h=>({style:h,type:"text"})),$(()=>J(null))))));X(o).pipe(P(this.destroyRef),he(()=>this.internalLoading.set(!1))).subscribe({next:l=>{this.internalUserStyles.set(t.map((h,C)=>{let V=l[C];return V?{id:h,style:V.style,type:V.type,loading:!1,error:!1}:{id:h,style:null,type:null,loading:!1,error:!0}}))},error:()=>{this.error.set("Failed to load styles"),this.internalUserStyles.update(l=>l.map(h=>G(j({},h),{loading:!1,error:!0})))}})}navigateToStyle(t){let o=ue(t)?"image":"text";this.router.navigate(["/details/styles",o,t.id])}openCreateForm(){this.readonly()||this.showCreateForm.set(!0)}closeCreateForm(){this.showCreateForm.set(!1)}onCreateStyle(t){if(this.readonly())return;this.creating.set(!0),(t.type==="image"?this.styleService.createImageStyle(t.payload):this.styleService.createTextStyle(t.payload)).pipe(P(this.destroyRef),he(()=>this.creating.set(!1))).subscribe({next:l=>{this.showCreateForm.set(!1),this.auth.refreshUser().subscribe(()=>{this.router.navigate(["/details/styles",t.type,l.id])})},error:l=>{this.error.set(l.message||"Failed to create style")}})}onEditStyle(t){if(this.readonly())return;let o=ue(t)?"image":"text";this.router.navigate(["/details/styles",o,t.id],{queryParams:{edit:"true"}})}onDeleteStyle(t){if(this.readonly()||!confirm("Are you sure you want to delete this style?"))return;((ue(t)?"image":"text")==="image"?this.styleService.deleteImageStyle(t.id):this.styleService.deleteTextStyle(t.id)).pipe(P(this.destroyRef)).subscribe({next:()=>{let h=this.userStyles().filter(C=>C.id!==t.id);this.internalUserStyles.set(h),this.stylesChange.emit(h),this.auth.refreshUser().subscribe()},error:h=>{this.error.set(h.message||"Failed to delete style")}})}};d.\u0275fac=function(o){return new(o||d)},d.\u0275cmp=D({type:d,selectors:[["app-profile-styles-list"]],inputs:{externalStyles:[1,"styles","externalStyles"],externalLoading:[1,"loadingExternal","externalLoading"],readonly:[1,"readonly"],compact:[1,"compact"]},outputs:{stylesChange:"stylesChange"},decls:20,vars:18,consts:[[1,"stack-lg"],[1,"details-tabs"],["type","button",1,"details-tab",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24","aria-hidden","true",1,"icon-sm"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"],[1,"text-secondary","text-sm"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M7.5 8.25h9m-9 3H12m-9.75 1.51c0 1.6 1.123 2.994 2.707 3.227 1.129.166 2.27.293 3.423.379.35.026.67.21.865.501L12 21l2.755-4.133a1.14 1.14 0 0 1 .865-.501 48.172 48.172 0 0 0 3.423-.379c1.584-.233 2.707-1.626 2.707-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0 0 12 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018Z"],["type","button",1,"btn-primary",3,"disabled"],[1,"card","card-bg-secondary","card-full"],[1,"state-container","state-container-sm","state-error"],[1,"state-container","state-container-sm","text-secondary"],[1,"action-row","action-row-responsive"],["type","button",1,"btn-primary",3,"click","disabled"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4.5v15m7.5-7.5h-15"],[3,"formSubmit","formCancel","mode","styleType","saving"],["fill","none","stroke","currentColor","viewBox","0 0 24 24","aria-hidden","true",1,"state-icon"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 9v3.75m9-.75a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 3.75h.008v.008H12v-.008Z"],["type","button",1,"btn-source-control",3,"click"],[1,"spinner","spinner-md"],[1,"state-container","state-container-sm","state-muted"],[1,"grid-cards"],["fill","none","stroke","currentColor","viewBox","0 0 24 24","aria-hidden","true",1,"state-icon-lg"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","1.5","d","M9.53 16.122a3 3 0 0 0-5.78 1.128 2.25 2.25 0 0 1-2.4 2.245 4.5 4.5 0 0 0 8.4-2.245c0-.399-.078-.78-.22-1.128Zm0 0a15.998 15.998 0 0 0 3.388-1.62m-5.043-.025a15.994 15.994 0 0 1 1.622-3.395m3.42 3.42a15.995 15.995 0 0 0 4.764-4.648l3.876-5.814a1.151 1.151 0 0 0-1.597-1.597L14.146 6.32a15.996 15.996 0 0 0-4.649 4.763m3.42 3.42a6.776 6.776 0 0 0-3.42-3.42"],[3,"style","styleType","showActions"],[3,"navigate","edit","delete","styleType","showActions"],["routerLink","/details/styles/",1,"btn-source-control"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"]],template:function(o,l){o&1&&(r(0,"div",0)(1,"div",1)(2,"button",2),b("click",function(){return l.setActiveTab("image")}),H(),r(3,"svg",3),k(4,"path",4),a(),s(5),p(6,"transloco"),u(7,Gt,2,1,"span",5),a(),ee(),r(8,"button",2),b("click",function(){return l.setActiveTab("text")}),H(),r(9,"svg",3),k(10,"path",6),a(),s(11),p(12,"transloco"),u(13,zt,2,1,"span",5),a(),u(14,Zt,5,4,"button",7),a(),u(15,Qt,2,3,"div",8),u(16,Yt,8,4,"div",9),u(17,Jt,5,3,"div",10),u(18,ii,2,1),u(19,ni,6,3,"div",11),a()),o&2&&(i(2),U("details-tab-active",l.activeTab()==="image"),i(3),m(" ",c(6,14,"styles.tabs.image")," "),i(2),x(l.imageCount()>0?7:-1),i(),U("details-tab-active",l.activeTab()==="text"),i(3),m(" ",c(12,16,"styles.tabs.text")," "),i(2),x(l.textCount()>0?13:-1),i(),x(l.readonly()?-1:14),i(),x(l.showCreateForm()&&!l.readonly()?15:-1),i(),x(l.error()?16:-1),i(),x(l.loading()&&!l.error()?17:-1),i(),x(!l.loading()&&!l.error()&&!l.showCreateForm()?18:-1),i(),x(!l.showCreateForm()&&!l.compact()?19:-1))},dependencies:[A,Re,Oe,ne],encapsulation:2,changeDetection:0});let e=d;return e})();var oi=e=>({username:e}),ai=e=>({age:e}),ri=e=>({amount:e}),li=(e,d)=>d.id;function si(e,d){if(e&1&&(s(0),p(1,"transloco")),e&2){let n=_();m(" ",ie(1,1,"profile.welcome",te(4,oi,n.auth.currentUser().username))," ")}}function di(e,d){e&1&&(s(0),p(1,"transloco")),e&2&&m(" ",c(1,1,"profile.login_title")," ")}function pi(e,d){e&1&&(r(0,"p",17)(1,"small"),s(2),p(3,"transloco"),a()()),e&2&&(i(2),f(c(3,1,"invalid_api_key")))}function ci(e,d){e&1&&(s(0),p(1,"transloco")),e&2&&m(" ",c(1,1,"profile.logging_in")," ")}function mi(e,d){e&1&&(s(0),p(1,"transloco")),e&2&&m(" ",c(1,1,"profile.login_button")," ")}function _i(e,d){if(e&1){let n=T();r(0,"div",8)(1,"div",10)(2,"h2",11),s(3),p(4,"transloco"),a(),r(5,"p",12),s(6),p(7,"transloco"),a(),r(8,"p",13),s(9),p(10,"transloco"),a(),r(11,"form",14),b("ngSubmit",function(){g(n);let o=_();return v(o.login())}),r(12,"div")(13,"label",15),s(14),p(15,"transloco"),a(),k(16,"input",16),p(17,"transloco"),a(),u(18,pi,4,3,"p",17),r(19,"div"),k(20,"app-toggle-checkbox",18),p(21,"transloco"),a(),r(22,"button",19),u(23,ci,2,3)(24,mi,2,3),a()(),r(25,"p",20),s(26),p(27,"transloco"),r(28,"a",21),s(29),p(30,"transloco"),a()()()()}if(e&2){let n=_();i(3),m(" ",c(4,16,"profile.login_title")," "),i(3),m(" ",c(7,18,"profile.login_description")," "),i(3),m(" ",c(10,20,"profile.no_auth_warning")," "),i(2),y("formGroup",n.form),i(3),f(c(15,22,"profile.api_key")),i(2),y("placeholder",c(17,24,"profile.api_key_placeholder")),i(2),x(n.loginError()?18:-1),i(2),y("description",c(21,26,"profile.remember_api_key")),i(2),U("btn-disabled",!n.form.valid||n.auth.isLoading())("btn-primary",n.form.valid&&!n.auth.isLoading()),y("disabled",!n.form.valid||n.auth.isLoading()),i(),x(n.auth.isLoading()?23:24),i(3),m(" ",c(27,28,"profile.no_account")," "),i(3),m(" ",c(30,30,"register_account")," ")}}function ui(e,d){if(e&1&&(r(0,"span",24),s(1),a()),e&2){let n=_(2);i(),m("(",n.auth.currentUser().worker_ids.length,")")}}function xi(e,d){if(e&1&&(r(0,"p",24),s(1),p(2,"transloco"),a()),e&2){let n=_(3);i(),m(" ",ie(2,1,"profile.account_age",te(4,ai,n.formatAccountAge(n.auth.currentUser().account_age)))," ")}}function fi(e,d){e&1&&(r(0,"span",33),p(1,"transloco"),s(2),p(3,"transloco"),a()),e&2&&(B("title",c(1,2,"admin.users.desc.trusted")),i(2),f(c(3,4,"profile.badge.trusted")))}function hi(e,d){e&1&&(r(0,"span",34),p(1,"transloco"),s(2),p(3,"transloco"),a()),e&2&&(B("title",c(1,2,"admin.users.desc.moderator")),i(2),f(c(3,4,"profile.badge.moderator")))}function Ci(e,d){e&1&&(r(0,"span",35),p(1,"transloco"),s(2),p(3,"transloco"),a()),e&2&&(B("title",c(1,2,"admin.users.desc.education")),i(2),f(c(3,4,"profile.badge.education")))}function yi(e,d){e&1&&(r(0,"span",36),p(1,"transloco"),s(2),p(3,"transloco"),a()),e&2&&(B("title",c(1,2,"admin.users.desc.service")),i(2),f(c(3,4,"profile.badge.service")))}function gi(e,d){e&1&&(r(0,"span",37),p(1,"transloco"),s(2),p(3,"transloco"),a()),e&2&&(B("title",c(1,2,"admin.users.desc.customizer")),i(2),f(c(3,4,"profile.badge.customizer")))}function vi(e,d){e&1&&(r(0,"span",38),p(1,"transloco"),s(2),p(3,"transloco"),a()),e&2&&(B("title",c(1,2,"admin.users.desc.special")),i(2),f(c(3,4,"profile.badge.special")))}function bi(e,d){e&1&&(r(0,"span",38),s(1),p(2,"transloco"),a()),e&2&&(i(),f(c(2,1,"profile.badge.anonymous")))}function ki(e,d){e&1&&(r(0,"span",36),p(1,"transloco"),s(2),p(3,"transloco"),a()),e&2&&(B("title",c(1,2,"admin.users.desc.filtered")),i(2),f(c(3,4,"profile.badge.filtered")))}function Si(e,d){e&1&&(r(0,"span",39),p(1,"transloco"),s(2),p(3,"transloco"),a()),e&2&&(B("title",c(1,2,"admin.users.desc.flagged")),i(2),f(c(3,4,"profile.badge.flagged")))}function Ei(e,d){if(e&1&&(r(0,"p",43),s(1),p(2,"formatNumber"),p(3,"transloco"),a()),e&2){let n=_(3);i(),m(" ",ie(3,3,"profile.monthly_kudos",te(6,ri,c(2,1,n.auth.currentUser().monthly_kudos.amount)))," ")}}function wi(e,d){if(e&1&&(r(0,"p",43)(1,"strong"),s(2,"Evaluating Kudos:"),a(),s(3),p(4,"formatNumber"),a()),e&2){let n=_(3);B("title","Evaluating Kudos from generations and uptime. When this reaches the threshold, you become trusted."),i(3),m(" ",c(4,2,n.auth.currentUser().evaluating_kudos)," ")}}function Ti(e,d){e&1&&(r(0,"div",44)(1,"h4",45),s(2),p(3,"transloco"),a(),r(4,"p",46),s(5),p(6,"transloco"),a(),r(7,"a",47),s(8),p(9,"transloco"),a()()),e&2&&(i(2),m(" ",c(3,3,"profile.low_kudos_info_title")," "),i(3),m(" ",c(6,5,"profile.low_kudos_info_message")," "),i(3),m(" ",c(9,7,"profile.low_kudos_info_link")," \u2192 "))}function Ii(e,d){e&1&&(r(0,"a",52),s(1),p(2,"transloco"),a()),e&2&&(i(),f(c(2,1,"profile.admin_panel")))}function Bi(e,d){if(e&1){let n=T();r(0,"div",48)(1,"h4",49),s(2),p(3,"transloco"),a(),k(4,"app-kudos-breakdown-panel",50),a(),r(5,"div",48)(6,"div",51),u(7,Ii,3,3,"a",52),r(8,"a",53),s(9),p(10,"transloco"),a(),r(11,"button",54),b("click",function(){g(n);let o=_(3);return v(o.logout())}),s(12),p(13,"transloco"),a()()()}if(e&2){let n=_(3);i(2),m(" ",c(3,6,"profile.kudos_breakdown")," "),i(2),y("kudosDetails",n.auth.currentUser().kudos_details)("showZeroValues",!1),i(3),x(n.auth.currentUser().moderator?7:-1),i(2),f(c(10,8,"profile.transfer_kudos")),i(3),m(" ",c(13,10,"profile.logout")," ")}}function Ki(e,d){if(e&1&&(r(0,"div",25)(1,"div",27)(2,"div",28)(3,"span",29),s(4),a()(),r(5,"div",30)(6,"h2",31),s(7),a(),r(8,"p",24),s(9),a(),u(10,xi,3,6,"p",24),a()(),r(11,"div",32),u(12,fi,4,6,"span",33),u(13,hi,4,6,"span",34),u(14,Ci,4,6,"span",35),u(15,yi,4,6,"span",36),u(16,gi,4,6,"span",37),u(17,vi,4,6,"span",38),u(18,bi,3,3,"span",38),u(19,ki,4,6,"span",36),u(20,Si,4,6,"span",39),a(),r(21,"h3",11),s(22),p(23,"transloco"),a(),r(24,"div",40)(25,"span",41),s(26),p(27,"formatNumber"),a(),r(28,"span",42),s(29),p(30,"transloco"),a()(),u(31,Ei,4,8,"p",43),u(32,wi,5,4,"p",43),u(33,Ti,10,9,"div",44),u(34,Bi,14,12),a()),e&2){let n,t=_(2);i(4),f(t.auth.currentUser().username.charAt(0).toUpperCase()),i(3),m(" ",t.auth.currentUser().username," "),i(2),m(" ID: ",t.auth.currentUser().id," "),i(),x(t.auth.currentUser().account_age?10:-1),i(2),x(t.auth.currentUser().trusted?12:-1),i(),x(t.auth.currentUser().moderator?13:-1),i(),x(t.auth.currentUser().education?14:-1),i(),x(t.auth.currentUser().service?15:-1),i(),x(t.auth.currentUser().customizer?16:-1),i(),x(t.auth.currentUser().special?17:-1),i(),x(t.auth.currentUser().pseudonymous?18:-1),i(),x(t.auth.currentUser().filtered?19:-1),i(),x(t.auth.currentUser().flagged?20:-1),i(2),f(c(23,20,"profile.kudos")),i(4),f(c(27,22,t.auth.currentUser().kudos)),i(3),f(c(30,24,"profile.kudos_balance")),i(2),x((n=t.auth.currentUser().monthly_kudos)!=null&&n.amount?31:-1),i(),x(t.auth.currentUser().evaluating_kudos!==void 0&&t.auth.currentUser().evaluating_kudos!==null&&!t.auth.currentUser().trusted?32:-1),i(),x(t.auth.currentUser().kudos<100?33:-1),i(),x(t.auth.currentUser().kudos_details?34:-1)}}function Pi(e,d){if(e&1&&(r(0,"div",58)(1,"span",59),s(2),p(3,"transloco"),a(),r(4,"span",60),s(5),r(6,"span",20),s(7," ("),k(8,"app-unit-tooltip",61),s(9,") "),a()()()),e&2){let n=d;B("title","Total megapixelsteps you have requested for image generation"),i(2),f(c(3,5,"profile.records.megapixelsteps")),i(3),m(" ",n.primary.formatted," "),i(3),y("unit",n)("swapDisplay",!0)}}function Vi(e,d){if(e&1&&(r(0,"div",58)(1,"span",59),s(2),p(3,"transloco"),a(),r(4,"span",60),s(5),r(6,"span",20),s(7," ("),k(8,"app-unit-tooltip",61),s(9,") "),a()()()),e&2){let n=d;B("title","Total tokens you have requested for text generation"),i(2),f(c(3,5,"profile.records.tokens")),i(3),m(" ",n.primary.formatted," "),i(3),y("unit",n)("swapDisplay",!0)}}function Li(e,d){if(e&1&&(r(0,"div",56)(1,"h4",49),s(2),p(3,"transloco"),a(),r(4,"div",57),u(5,Pi,10,7,"div",58),u(6,Vi,10,7,"div",58),a()()),e&2){let n,t,o=_(3);i(2),m(" ",c(3,3,"profile.records.usage")," "),i(3),x((n=o.usageMegapixelsteps())?5:-1,n),i(),x((t=o.usageTokens())?6:-1,t)}}function Ui(e,d){if(e&1&&(r(0,"div",58)(1,"span",59),s(2),p(3,"transloco"),a(),r(4,"span",60),s(5),r(6,"span",20),s(7," ("),k(8,"app-unit-tooltip",61),s(9,") "),a()()()),e&2){let n=d;B("title","Total megapixelsteps your workers have generated"),i(2),f(c(3,5,"profile.records.megapixelsteps")),i(3),m(" ",n.primary.formatted," "),i(3),y("unit",n)("swapDisplay",!0)}}function Fi(e,d){if(e&1&&(r(0,"div",58)(1,"span",59),s(2),p(3,"transloco"),a(),r(4,"span",60),s(5),r(6,"span",20),s(7," ("),k(8,"app-unit-tooltip",61),s(9,") "),a()()()),e&2){let n=d;B("title","Total tokens your workers have generated"),i(2),f(c(3,5,"profile.records.tokens")),i(3),m(" ",n.primary.formatted," "),i(3),y("unit",n)("swapDisplay",!0)}}function Di(e,d){if(e&1&&(r(0,"div",56)(1,"h4",49),s(2),p(3,"transloco"),a(),r(4,"div",57),u(5,Ui,10,7,"div",58),u(6,Fi,10,7,"div",58),a()()),e&2){let n,t,o=_(3);i(2),m(" ",c(3,3,"profile.records.contribution")," "),i(3),x((n=o.contributionMegapixelsteps())?5:-1,n),i(),x((t=o.contributionTokens())?6:-1,t)}}function Mi(e,d){if(e&1&&(r(0,"div",63)(1,"span",59),s(2),p(3,"transloco"),a(),r(4,"span",60),s(5),p(6,"formatNumber"),a()()),e&2){let n=_(4);B("title","Total image generation requests you have made"),i(2),f(c(3,3,"profile.records.image")),i(3),f(c(6,5,n.auth.currentUser().records.request.image??0))}}function Ai(e,d){if(e&1&&(r(0,"div",63)(1,"span",59),s(2),p(3,"transloco"),a(),r(4,"span",60),s(5),p(6,"formatNumber"),a()()),e&2){let n=_(4);B("title","Total text generation requests you have made"),i(2),f(c(3,3,"profile.records.text")),i(3),f(c(6,5,n.auth.currentUser().records.request.text??0))}}function Ni(e,d){if(e&1&&(r(0,"div",63)(1,"span",59),s(2),p(3,"transloco"),a(),r(4,"span",60),s(5),p(6,"formatNumber"),a()()),e&2){let n=_(4);B("title","Total image interrogation requests you have made"),i(2),f(c(3,3,"profile.records.interrogation")),i(3),f(c(6,5,n.auth.currentUser().records.request.interrogation??0))}}function $i(e,d){if(e&1&&(r(0,"div",56)(1,"h4",49),s(2),p(3,"transloco"),a(),r(4,"div",62),u(5,Mi,7,7,"div",63),u(6,Ai,7,7,"div",63),u(7,Ni,7,7,"div",63),a()()),e&2){let n=_(3);i(2),m(" ",c(3,4,"profile.records.requests")," "),i(3),x(n.auth.currentUser().records.request.image?5:-1),i(),x(n.auth.currentUser().records.request.text?6:-1),i(),x(n.auth.currentUser().records.request.interrogation?7:-1)}}function Wi(e,d){if(e&1&&(r(0,"div",63)(1,"span",59),s(2),p(3,"transloco"),a(),r(4,"span",60),s(5),p(6,"formatNumber"),a()()),e&2){let n=_(4);B("title","Total image generations your workers have fulfilled"),i(2),f(c(3,3,"profile.records.image")),i(3),f(c(6,5,n.auth.currentUser().records.fulfillment.image??0))}}function qi(e,d){if(e&1&&(r(0,"div",63)(1,"span",59),s(2),p(3,"transloco"),a(),r(4,"span",60),s(5),p(6,"formatNumber"),a()()),e&2){let n=_(4);B("title","Total text generations your workers have fulfilled"),i(2),f(c(3,3,"profile.records.text")),i(3),f(c(6,5,n.auth.currentUser().records.fulfillment.text??0))}}function Ri(e,d){if(e&1&&(r(0,"div",63)(1,"span",59),s(2),p(3,"transloco"),a(),r(4,"span",60),s(5),p(6,"formatNumber"),a()()),e&2){let n=_(4);B("title","Total image interrogations your workers have fulfilled"),i(2),f(c(3,3,"profile.records.interrogation")),i(3),f(c(6,5,n.auth.currentUser().records.fulfillment.interrogation??0))}}function Oi(e,d){if(e&1&&(r(0,"div",56)(1,"h4",49),s(2),p(3,"transloco"),a(),r(4,"div",62),u(5,Wi,7,7,"div",63),u(6,qi,7,7,"div",63),u(7,Ri,7,7,"div",63),a()()),e&2){let n=_(3);i(2),m(" ",c(3,4,"profile.records.fulfillments")," "),i(3),x(n.auth.currentUser().records.fulfillment.image?5:-1),i(),x(n.auth.currentUser().records.fulfillment.text?6:-1),i(),x(n.auth.currentUser().records.fulfillment.interrogation?7:-1)}}function Hi(e,d){if(e&1&&(r(0,"div",26)(1,"h3",11),s(2),p(3,"transloco"),a(),r(4,"div",55),u(5,Li,7,5,"div",56),u(6,Di,7,5,"div",56),u(7,$i,8,6,"div",56),u(8,Oi,8,6,"div",56),a()()),e&2){let n=_(2);i(2),m(" ",c(3,5,"profile.detailed_records")," "),i(3),x(n.auth.currentUser().records.usage?5:-1),i(),x(n.auth.currentUser().records.contribution?6:-1),i(),x(n.auth.currentUser().records.request?7:-1),i(),x(n.auth.currentUser().records.fulfillment?8:-1)}}function ji(e,d){if(e&1&&(r(0,"span",24),s(1),a()),e&2){let n=_(3);i(),m("(",n.auth.currentUser().worker_ids.length,")")}}function Gi(e,d){e&1&&(r(0,"p",64),s(1),p(2,"transloco"),a()),e&2&&(i(),m(" ",c(2,1,"profile.no_workers_registered")," "))}function zi(e,d){e&1&&(r(0,"p",80),s(1),p(2,"transloco"),a()),e&2&&(i(),m(" ",c(2,1,"profile.loading_workers")," "))}function Zi(e,d){e&1&&(r(0,"p",64),s(1),p(2,"transloco"),a()),e&2&&(i(),m(" ",c(2,1,"profile.no_workers_match_filters")," "))}function Qi(e,d){if(e&1&&(r(0,"div",82)(1,"p",85),s(2),a(),k(3,"div",86)(4,"div",87),r(5,"p",24),s(6),p(7,"transloco"),a()()),e&2){let n=_().$implicit;i(2),m(" ",n.id," "),i(4),m(" ",c(7,2,"profile.loading_workers")," ")}}function Yi(e,d){if(e&1){let n=T();r(0,"app-worker-card",88),b("workerUpdated",function(){g(n);let o=_(6);return v(o.onWorkerUpdated())}),a()}if(e&2){let n,t=_().$implicit,o=_(5);y("worker",t.worker)("isModerator",((n=o.auth.currentUser())==null?null:n.moderator)??!1)}}function Ji(e,d){if(e&1&&(r(0,"div",84)(1,"p",85),s(2),a(),r(3,"p",24),s(4),p(5,"transloco"),a()()),e&2){let n=_().$implicit;i(2),m(" ",n.id," "),i(2),m(" ",c(5,2,"profile.no_workers_found")," ")}}function Xi(e,d){if(e&1&&u(0,Qi,8,4,"div",82)(1,Yi,1,2,"app-worker-card",83)(2,Ji,6,4,"div",84),e&2){let n=d.$implicit;x(n.loading?0:n.worker?1:2)}}function en(e,d){if(e&1&&(r(0,"div",81),q(1,Xi,3,1,null,null,li),a()),e&2){let n=_(4);i(),R(n.filteredAndSortedWorkers())}}function tn(e,d){if(e&1){let n=T();r(0,"div",65)(1,"div",66)(2,"label",67),s(3),p(4,"transloco"),a(),r(5,"input",68),p(6,"transloco"),b("input",function(o){g(n);let l=_(3);return v(l.onFilterTextChange(o))}),a()(),r(7,"div")(8,"label",69),s(9),p(10,"transloco"),a(),r(11,"select",70),b("change",function(o){g(n);let l=_(3);return v(l.onFilterTypeChange(o.target.value))}),r(12,"option",71),s(13),p(14,"transloco"),a(),r(15,"option",72),s(16),p(17,"transloco"),a(),r(18,"option",73),s(19),p(20,"transloco"),a(),r(21,"option",74),s(22),p(23,"transloco"),a()()(),r(24,"div")(25,"label",75),s(26),p(27,"transloco"),a(),r(28,"select",76),b("change",function(o){g(n);let l=_(3);return v(l.onFilterMaintenanceChange(o.target.value))}),r(29,"option",71),s(30),p(31,"transloco"),a(),r(32,"option",77),s(33),p(34,"transloco"),a(),r(35,"option",78),s(36),p(37,"transloco"),a(),r(38,"option",79),s(39),p(40,"transloco"),a()()()(),u(41,zi,3,3,"p",80),u(42,Zi,3,3,"p",64)(43,en,3,0,"div",81)}if(e&2){let n=_(3);i(3),f(c(4,17,"profile.workers.search")),i(2),y("value",n.filterText())("placeholder",c(6,19,"profile.workers.search_placeholder")),i(4),f(c(10,21,"profile.workers.type")),i(2),y("value",n.filterWorkerType()),i(2),m(" ",c(14,23,"profile.workers.type.all")," "),i(3),m(" ",c(17,25,"profile.workers.type.image")," "),i(3),m(" ",c(20,27,"profile.workers.type.text")," "),i(3),m(" ",c(23,29,"profile.workers.type.interrogation")," "),i(4),f(c(27,31,"profile.workers.status")),i(2),y("value",n.filterMaintenance()),i(2),m(" ",c(31,33,"profile.workers.status.all")," "),i(3),m(" ",c(34,35,"profile.workers.status.active")," "),i(3),m(" ",c(37,37,"profile.workers.status.maintenance")," "),i(3),m(" ",c(40,39,"profile.workers.status.offline")," "),i(2),x(n.loadingWorkers()?41:-1),i(),x(!n.loadingWorkers()&&n.filteredAndSortedWorkers().length===0&&n.userWorkers().length>0?42:43)}}function nn(e,d){if(e&1&&(r(0,"div",26)(1,"h3",11),s(2),p(3,"transloco"),u(4,ji,2,1,"span",24),a(),u(5,Gi,3,3,"p",64)(6,tn,44,41),a()),e&2){let n=_(2);i(2),m(" ",c(3,3,"profile.your_workers")," "),i(2),x(n.auth.currentUser().worker_ids&&n.auth.currentUser().worker_ids.length>0?4:-1),i(),x(!n.auth.currentUser().worker_ids||n.auth.currentUser().worker_ids.length===0?5:6)}}function on(e,d){if(e&1&&(r(0,"span",24),s(1),a()),e&2){let n=_(3);i(),m("(",n.auth.currentUser().styles.length,")")}}function an(e,d){if(e&1&&(r(0,"div",26)(1,"h3",11),s(2),p(3,"transloco"),u(4,on,2,1,"span",24),a(),k(5,"app-profile-styles-list"),a()),e&2){let n=_(2);i(2),m(" ",c(3,2,"profile.tabs.styles")," "),i(2),x(n.auth.currentUser().styles&&n.auth.currentUser().styles.length>0?4:-1)}}function rn(e,d){e&1&&(r(0,"div",26),k(1,"app-shared-key-list"),a())}function ln(e,d){if(e&1){let n=T();r(0,"div",9)(1,"div",22)(2,"button",23),b("click",function(){g(n);let o=_();return v(o.setActiveTab("profile"))}),s(3),p(4,"transloco"),a(),r(5,"button",23),b("click",function(){g(n);let o=_();return v(o.setActiveTab("records"))}),s(6),p(7,"transloco"),a(),r(8,"button",23),b("click",function(){g(n);let o=_();return v(o.setActiveTab("workers"))}),s(9),p(10,"transloco"),u(11,ui,2,1,"span",24),a(),r(12,"button",23),b("click",function(){g(n);let o=_();return v(o.setActiveTab("styles"))}),s(13),p(14,"transloco"),a(),r(15,"button",23),b("click",function(){g(n);let o=_();return v(o.setActiveTab("shared-keys"))}),s(16),p(17,"transloco"),a()(),u(18,Ki,35,26,"div",25),u(19,Hi,9,7,"div",26),u(20,nn,7,5,"div",26),u(21,an,6,4,"div",26),u(22,rn,2,0,"div",26),a()}if(e&2){let n=_();i(2),U("details-tab-active",n.activeTab()==="profile"),i(),m(" ",c(4,21,"profile.tabs.profile")," "),i(2),U("details-tab-active",n.activeTab()==="records"),i(),m(" ",c(7,23,"profile.tabs.detailed_records")," "),i(2),U("details-tab-active",n.activeTab()==="workers"),i(),m(" ",c(10,25,"profile.tabs.your_workers")," "),i(2),x(n.auth.currentUser().worker_ids&&n.auth.currentUser().worker_ids.length>0?11:-1),i(),U("details-tab-active",n.activeTab()==="styles"),i(),m(" ",c(14,27,"profile.tabs.styles")," "),i(2),U("details-tab-active",n.activeTab()==="shared-keys"),i(),m(" ",c(17,29,"profile.tabs.shared_keys")," "),i(2),x(n.activeTab()==="profile"?18:-1),i(),x(n.activeTab()==="records"&&(n.auth.currentUser().records||n.auth.currentUser().usage||n.auth.currentUser().contributions)?19:-1),i(),x(n.activeTab()==="workers"?20:-1),i(),x(n.activeTab()==="styles"?21:-1),i(),x(n.activeTab()==="shared-keys"?22:-1)}}var wo=(()=>{let d=class d{constructor(){this.title=w(Be),this.translator=w(Ue),this.footerColor=w(Fe),this.destroyRef=w(W),this.workerService=w($e),this.auth=w(O),this.units=w(Le),this.workerRequestConcurrency=3,this.loginError=S(!1),this.activeTab=S("profile"),this.userWorkers=S([]),this.loadingWorkers=S(!1),this.workersExpanded=S(!1),this.filterText=S(""),this.filterWorkerType=S("all"),this.filterMaintenance=S("all"),this.filteredAndSortedWorkers=E(()=>{let t=this.userWorkers().filter(C=>C.worker!==null),o=this.filterWorkerType();o!=="all"&&(t=t.filter(C=>C.worker.type===o));let l=this.filterMaintenance();l==="active"?t=t.filter(C=>C.worker.online):l==="maintenance"?t=t.filter(C=>C.worker.maintenance_mode):l==="offline"&&(t=t.filter(C=>!C.worker.online));let h=this.filterText().toLowerCase();return h&&(t=t.filter(C=>C.worker.name.toLowerCase().includes(h)||(C.worker.id??"").toLowerCase().includes(h))),[...t].sort((C,V)=>{let Y=Number(this.isActiveWorker(V.worker))-Number(this.isActiveWorker(C.worker));if(Y!==0)return Y;let Qe=C.worker?.name??"",Ye=V.worker?.name??"";return Qe.localeCompare(Ye)})}),this.recordsExpanded=S(!1),this.usageMegapixelsteps=E(()=>{let t=this.auth.currentUser();if(!t?.records?.usage?.megapixelsteps)return null;let o=t.records.usage.megapixelsteps*1e6;return this.units.formatTotalPixelsteps(o)}),this.usageTokens=E(()=>{let t=this.auth.currentUser();return t?.records?.usage?.tokens?this.units.formatTotalTokens(t.records.usage.tokens):null}),this.contributionMegapixelsteps=E(()=>{let t=this.auth.currentUser();if(!t?.records?.contribution?.megapixelsteps)return null;let o=t.records.contribution.megapixelsteps*1e6;return this.units.formatTotalPixelsteps(o)}),this.contributionTokens=E(()=>{let t=this.auth.currentUser();return t?.records?.contribution?.tokens?this.units.formatTotalTokens(t.records.contribution.tokens):null}),this.form=new le({apiKey:new L("",[K.required]),remember:new L(!1)})}ngOnInit(){ge([this.translator.get("profile.title"),this.translator.get("app_title")]).pipe(P(this.destroyRef)).subscribe(([t,o])=>{this.title.setTitle(`${t} | ${o}`)}),this.footerColor.setDarkMode(!0),this.form.controls.apiKey.valueChanges.pipe(P(this.destroyRef)).subscribe(()=>{this.loginError.set(!1)})}login(){this.form.valid&&(this.loginError.set(!1),this.auth.login(this.form.value.apiKey,this.form.value.remember??!1).subscribe(t=>{t?this.form.reset():this.loginError.set(!0)}))}logout(){this.auth.logout()}formatAccountAge(t){let o=Math.floor(t/86400);if(o>365){let l=Math.floor(o/365),h=o%365;return`${l} year${l!==1?"s":""}, ${h} day${h!==1?"s":""}`}return`${o} day${o!==1?"s":""}`}toggleWorkersSection(){let t=!this.workersExpanded();this.workersExpanded.set(t),t&&this.userWorkers().length===0&&this.loadUserWorkers()}toggleRecordsSection(){this.recordsExpanded.set(!this.recordsExpanded())}setActiveTab(t){this.activeTab.set(t),t==="workers"&&this.userWorkers().length===0&&this.loadUserWorkers()}loadUserWorkers(){let o=this.auth.currentUser()?.worker_ids??[];o.length!==0&&(this.loadingWorkers.set(!0),this.userWorkers.set(o.map(l=>({id:l,loading:!0,worker:null}))),ye(o).pipe(ve(l=>this.workerService.getWorker(l).pipe(N(h=>({id:l,worker:h}))),this.workerRequestConcurrency),P(this.destroyRef)).subscribe({next:({id:l,worker:h})=>{this.userWorkers.update(C=>C.map(V=>V.id===l?G(j({},V),{worker:h,loading:!1}):V))},error:()=>{this.loadingWorkers.set(!1),this.userWorkers.update(l=>l.map(h=>G(j({},h),{loading:!1})))},complete:()=>{this.userWorkers.update(l=>this.sortWorkers(l)),this.loadingWorkers.set(!1)}}))}onWorkerUpdated(){this.loadUserWorkers()}onFilterTextChange(t){let o=t.target;this.filterText.set(o.value)}onFilterTypeChange(t){this.filterWorkerType.set(t)}onFilterMaintenanceChange(t){this.filterMaintenance.set(t)}sortWorkers(t){return[...t.map(l=>l.loading?G(j({},l),{loading:!1}):l)].sort((l,h)=>{let C=Number(this.isActiveWorker(h.worker))-Number(this.isActiveWorker(l.worker));if(C!==0)return C;let V=l.worker?.name??"",Y=h.worker?.name??"";return V.localeCompare(Y)})}isActiveWorker(t){return t?t.online&&!t.paused&&!t.maintenance_mode:!1}};d.\u0275fac=function(o){return new(o||d)},d.\u0275cmp=D({type:d,selectors:[["app-profile"]],decls:12,vars:2,consts:[[1,"section-primary"],[1,"container-page-header"],[1,"place-center"],[1,"heading-hero"],[1,"section-secondary"],[1,"container-spaced"],[1,"grid-items"],[1,"text-secondary","sm:text-lg"],[1,"container-centered-md"],[1,"container-page-content"],[1,"card","card-bg-primary"],[1,"heading-card"],[1,"text-intro"],[1,"text-intro","text-secondary"],[3,"ngSubmit","formGroup"],["for","api_key",1,"form-label"],["formControlName","apiKey","type","password","id","api_key","required","",1,"form-input",3,"placeholder"],[1,"text-error"],["formControlName","remember",3,"description"],["type","submit",3,"disabled"],[1,"text-secondary"],["href","https://aihorde.net/register","target","_blank","rel","noopener noreferrer",1,"link"],[1,"details-tabs"],[1,"details-tab",3,"click"],[1,"text-secondary","text-sm"],[1,"card","card-bg-primary","card-full"],[1,"card","card-bg-primary","card-full","card-spaced"],[1,"profile-header","section-divider-bottom"],[1,"avatar-circle","avatar-lg","avatar-gradient"],[1,"avatar-text"],[1,"profile-header-content"],[1,"heading-subsection"],[1,"badge-container"],[1,"badge-base","badge-success"],[1,"badge-base","badge-purple"],[1,"badge-base","badge-info"],[1,"badge-base","badge-warning"],[1,"badge-base","badge-pink"],[1,"badge-base","badge-secondary"],[1,"badge-base","badge-danger"],[1,"highlight-box"],[1,"data-value-xl"],[1,"data-label-spaced"],[1,"text-secondary","text-sm","text-center"],[1,"mt-4","p-4","bg-blue-50","dark:bg-blue-900/20","border","border-blue-200","dark:border-blue-800","rounded-lg"],[1,"text-sm","font-semibold","text-blue-900","dark:text-blue-100","mb-2"],[1,"text-sm","text-blue-800","dark:text-blue-200","mb-3"],["routerLink","/faq/","fragment","kudos",1,"text-sm","font-medium","text-blue-600","dark:text-blue-400","hover:underline"],[1,"section-divider-top"],[1,"section-title-sm"],["variant","profile",3,"kudosDetails","showZeroValues"],[1,"action-row"],["routerLink","/admin/",1,"btn-primary"],["routerLink","/v2-transfer/",1,"btn-primary"],[1,"btn-source-control",3,"click"],[1,"records-section-wrapper"],[1,"record-group"],[1,"data-grid-1-2"],[1,"data-item-box"],[1,"data-label"],[1,"data-value"],[3,"unit","swapDisplay"],[1,"data-grid-1-2-3"],[1,"data-item-box","data-item-centered"],[1,"text-secondary","text-center","py-4"],[1,"mb-4","flex","flex-wrap","gap-3","items-end"],[1,"flex-1","min-w-[200px]"],["for","worker-search",1,"form-label","text-sm"],["type","text","id","worker-search",1,"form-input",3,"input","value","placeholder"],["for","worker-type",1,"form-label","text-sm"],["id","worker-type",1,"form-input",3,"change","value"],["value","all"],["value","image"],["value","text"],["value","interrogation"],["for","worker-status",1,"form-label","text-sm"],["id","worker-status",1,"form-input",3,"change","value"],["value","active"],["value","maintenance"],["value","offline"],[1,"text-secondary","text-sm","mb-2"],[1,"worker-grid"],["aria-busy","true",1,"skeleton-box"],[3,"worker","isModerator"],["role","status",1,"skeleton-box","skeleton-box-dashed"],[1,"data-value","text-sm","break-all"],[1,"skeleton-bar","skeleton-bar-sm"],[1,"skeleton-bar","skeleton-bar-lg"],[3,"workerUpdated","worker","isModerator"]],template:function(o,l){o&1&&(r(0,"section",0)(1,"div",1)(2,"div",2)(3,"h1",3),u(4,si,2,6)(5,di,2,3),a()()()(),r(6,"section",4)(7,"div",5)(8,"div",6)(9,"div",7),u(10,_i,31,32,"div",8)(11,ln,23,31,"div",9),a()()()()),o&2&&(i(4),x(l.auth.isLoggedIn()?4:5),i(6),x(l.auth.isLoggedIn()?11:10))},dependencies:[A,Pe,me,ce,se,Me,Ae,oe,ae,re,Ne,de,pe,_e,ne,We,ze,Ze,He,Ve],encapsulation:2,changeDetection:0});let e=d;return e})();export{wo as ProfileComponent};
