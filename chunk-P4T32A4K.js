import{a as O,b as z}from"./chunk-2GSLEGZS.js";import{a as W}from"./chunk-ISHBUXAM.js";import{a as N}from"./chunk-VFTR325L.js";import{c as R}from"./chunk-BMIYH3UD.js";import{g as Z,l as G}from"./chunk-3GXWXVSS.js";import{k as D}from"./chunk-GZDNXZTC.js";import{Cb as h,Db as c,F as q,Oa as t,Ob as C,Rb as l,Sb as u,Tb as x,X as L,Za as U,aa as b,ba as M,ca as k,da as w,ga as Q,gb as H,gc as m,hc as p,ic as B,ja as g,nc as I,ob as _,pb as v,r as j,rb as A,sb as $,tb as y,ub as o,vb as a,wb as f,zb as V}from"./chunk-QF4LG6ZD.js";import"./chunk-4CLCTAJ7.js";var J=(i,s)=>s.name;function K(i,s){i&1&&f(0,"div",7)}function X(i,s){i&1&&(k(),o(0,"svg",3),f(1,"path",12),a())}function Y(i,s){if(i&1&&(o(0,"div",8)(1,"div",13)(2,"span",14),l(3),m(4,"transloco"),a(),o(5,"span",15),l(6),a()(),o(7,"div",13)(8,"span",14),l(9),m(10,"transloco"),a(),o(11,"span",15),l(12),o(13,"span",16),l(14," ("),f(15,"app-unit-tooltip",17),l(16,") "),a()()()()),i&2){let n=c();t(3),u(p(4,6,"details.models.total_models")),t(3),u(n.formatNumber(n.currentModels().length)),t(3),u(p(10,8,"details.models.total_queued")),t(3),x(" ",n.totalQueuedUnit().primary.formatted," "),t(3),y("unit",n.totalQueuedUnit())("swapDisplay",!0)}}function ee(i,s){if(i&1){let n=V();o(0,"div",9)(1,"div",18),k(),o(2,"svg",19),f(3,"path",20),a(),w(),o(4,"input",21),m(5,"transloco"),h("input",function(r){b(n);let d=c();return M(d.onSearchChange(r))}),a()()()}if(i&2){let n=c();t(4),y("placeholder",p(5,2,"details.models.search_placeholder"))("value",n.searchQuery())}}function te(i,s){if(i&1){let n=V();o(0,"div",10),k(),o(1,"svg",22),f(2,"path",23),a(),w(),o(3,"p"),l(4),a(),o(5,"button",24),h("click",function(){b(n);let r=c();return M(r.loadModels())}),l(6),m(7,"transloco"),a()()}if(i&2){let n=c();t(4),u(n.error()),t(2),x(" ",p(7,2,"details.models.retry")," ")}}function ie(i,s){i&1&&(o(0,"div",11),f(1,"div",25),o(2,"p"),l(3),m(4,"transloco"),a()()),i&2&&(t(3),u(p(4,1,"details.models.loading")))}function ne(i,s){i&1&&(o(0,"p"),l(1),m(2,"transloco"),a()),i&2&&(t(),u(p(2,1,"details.models.no_results")))}function oe(i,s){i&1&&(o(0,"p"),l(1),m(2,"transloco"),a()),i&2&&(t(),u(p(2,1,"details.models.no_models")))}function ae(i,s){if(i&1&&(o(0,"div",26),k(),o(1,"svg",28),f(2,"path",29),a(),_(3,ne,3,3,"p")(4,oe,3,3,"p"),a()),i&2){let n=c(2);t(3),v(n.searchQuery()?3:4)}}function le(i,s){if(i&1&&(o(0,"span",32),l(1),a()),i&2){let n=c(3);t(),u(n.sortDirection()==="asc"?"\u2191":"\u2193")}}function re(i,s){if(i&1&&(o(0,"span",32),l(1),a()),i&2){let n=c(3);t(),u(n.sortDirection()==="asc"?"\u2191":"\u2193")}}function se(i,s){if(i&1&&(o(0,"span",32),l(1),a()),i&2){let n=c(3);t(),u(n.sortDirection()==="asc"?"\u2191":"\u2193")}}function de(i,s){if(i&1&&(o(0,"span",32),l(1),a()),i&2){let n=c(3);t(),u(n.sortDirection()==="asc"?"\u2191":"\u2193")}}function ce(i,s){if(i&1&&(o(0,"span",32),l(1),a()),i&2){let n=c(3);t(),u(n.sortDirection()==="asc"?"\u2191":"\u2193")}}function me(i,s){if(i&1&&(o(0,"span",32),l(1),a()),i&2){let n=c(3);t(),u(n.sortDirection()==="asc"?"\u2191":"\u2193")}}function pe(i,s){if(i&1&&(l(0),m(1,"number"),f(2,"app-unit-tooltip",40)),i&2){let n=c().$implicit,e=c(3).getModelQueuedUnit(n);x(" ",B(1,3,e.primary.value,"1.1-1")," "),t(2),y("unit",e)("primaryOverride",e.primary.prefix+e.primary.unit)}}function ue(i,s){i&1&&l(0," - ")}function _e(i,s){if(i&1&&(l(0),m(1,"number"),f(2,"app-unit-tooltip",40)),i&2){let n=s;x(" ",B(1,3,n.primary.value,"1.2-2")," "),t(2),y("unit",n)("primaryOverride",n.primary.prefix+n.primary.unit)}}function ve(i,s){i&1&&l(0," - ")}function xe(i,s){if(i&1&&(o(0,"div",34)(1,"div",35)(2,"span",36),l(3),a()(),o(4,"div",37)(5,"span",38),l(6),m(7,"transloco"),a(),o(8,"span",39),l(9),a()(),o(10,"div",37)(11,"span",38),l(12),m(13,"transloco"),a(),o(14,"span",39),_(15,pe,3,6)(16,ue,1,0),a()(),o(17,"div",37)(18,"span",38),l(19),m(20,"transloco"),a(),o(21,"span",39),l(22),a()(),o(23,"div",37)(24,"span",38),l(25),m(26,"transloco"),a(),o(27,"span",39),l(28),a()(),o(29,"div",37)(30,"span",38),l(31),m(32,"transloco"),a(),o(33,"span",39),_(34,_e,3,6)(35,ve,1,0),a()()()),i&2){let n,e=s.$implicit,r=c(3);t(2),y("title",e.name),t(),u(e.name),t(3),u(p(7,24,"details.models.workers")),t(2),C("models-table-value-highlight",e.count>10)("models-table-value-muted",e.count===0),t(),x(" ",r.formatNumber(e.count)," "),t(3),u(p(13,26,"details.models.queued")),t(2),C("models-table-value-muted",e.queued===0),t(),v(e.queued&&e.queued>0?15:16),t(4),u(p(20,28,"details.models.jobs")),t(2),C("models-table-value-muted",e.jobs===0),t(),x(" ",r.formatNumber(e.jobs)," "),t(3),u(p(26,30,"details.models.eta")),t(2),C("models-table-value-muted",!e.eta||e.eta<=0),t(),x(" ",r.formatEta(e.eta)," "),t(3),u(p(32,32,"details.models.performance")),t(2),C("models-table-value-muted",!e.performance||e.performance<=0),t(),v((n=r.getModelPerformanceUnit(e))?34:35,n)}}function Ce(i,s){if(i&1){let n=V();o(0,"div",27)(1,"div",30)(2,"button",31),h("click",function(){b(n);let r=c(2);return M(r.setSortField("name"))}),l(3),m(4,"transloco"),_(5,le,2,1,"span",32),a(),o(6,"button",33),h("click",function(){b(n);let r=c(2);return M(r.setSortField("count"))}),l(7),m(8,"transloco"),_(9,re,2,1,"span",32),a(),o(10,"button",33),h("click",function(){b(n);let r=c(2);return M(r.setSortField("queued"))}),l(11),m(12,"transloco"),_(13,se,2,1,"span",32),a(),o(14,"button",33),h("click",function(){b(n);let r=c(2);return M(r.setSortField("jobs"))}),l(15),m(16,"transloco"),_(17,de,2,1,"span",32),a(),o(18,"button",33),h("click",function(){b(n);let r=c(2);return M(r.setSortField("eta"))}),l(19),m(20,"transloco"),_(21,ce,2,1,"span",32),a(),o(22,"button",33),h("click",function(){b(n);let r=c(2);return M(r.setSortField("performance"))}),l(23),m(24,"transloco"),_(25,me,2,1,"span",32),a()(),A(26,xe,36,34,"div",34,J),a()}if(i&2){let n=c(2);t(2),C("models-table-th-active",n.sortField()==="name"),t(),x(" ",p(4,24,"details.models.sort.name")," "),t(2),v(n.sortField()==="name"?5:-1),t(),C("models-table-th-active",n.sortField()==="count"),t(),x(" ",p(8,26,"details.models.workers")," "),t(2),v(n.sortField()==="count"?9:-1),t(),C("models-table-th-active",n.sortField()==="queued"),t(),x(" ",p(12,28,"details.models.queued")," "),t(2),v(n.sortField()==="queued"?13:-1),t(),C("models-table-th-active",n.sortField()==="jobs"),t(),x(" ",p(16,30,"details.models.jobs")," "),t(2),v(n.sortField()==="jobs"?17:-1),t(),C("models-table-th-active",n.sortField()==="eta"),t(),x(" ",p(20,32,"details.models.eta")," "),t(2),v(n.sortField()==="eta"?21:-1),t(),C("models-table-th-active",n.sortField()==="performance"),t(),x(" ",p(24,34,"details.models.performance")," "),t(2),v(n.sortField()==="performance"?25:-1),t(),$(n.filteredModels())}}function fe(i,s){if(i&1&&_(0,ae,5,1,"div",26)(1,Ce,28,36,"div",27),i&2){let n=c();v(n.filteredModels().length===0?0:1)}}var Be=(()=>{let s=class s{getModelQueuedUnit(e){return this.activeTab()==="image"?this.unitConversion.formatModelQueuedImage(e.queued??0):this.unitConversion.formatModelQueuedText(e.queued??0)}getModelPerformanceUnit(e){return!e.performance||e.performance<=0?null:this.activeTab()==="image"?this.unitConversion.formatModelPerformanceImage(e.performance):this.unitConversion.formatModelPerformanceText(e.performance)}constructor(){this.title=L(G),this.translator=L(W),this.aiHorde=L(N),this.destroyRef=L(Q),this.unitConversion=L(z),this.activeTab=g("image"),this.loading=g(!1),this.error=g(null),this.imageModels=g([]),this.textModels=g([]),this.searchQuery=g(""),this.sortField=g("count"),this.sortDirection=g("desc"),this.currentModels=I(()=>this.activeTab()==="image"?this.imageModels():this.textModels()),this.filteredModels=I(()=>{let e=this.currentModels(),r=this.searchQuery().toLowerCase().trim(),d=this.sortField(),F=this.sortDirection(),P=e;return r&&(P=e.filter(S=>S.name.toLowerCase().includes(r))),[...P].sort((S,E)=>{let T=0;return d==="name"?T=S.name.localeCompare(E.name):d==="count"?T=(S.count??0)-(E.count??0):d==="queued"?T=(S.queued??0)-(E.queued??0):d==="jobs"?T=(S.jobs??0)-(E.jobs??0):d==="eta"?T=(S.eta??0)-(E.eta??0):d==="performance"&&(T=(S.performance??0)-(E.performance??0)),F==="asc"?T:-T})}),this.totalWorkers=I(()=>this.currentModels().reduce((e,r)=>e+(r.count??0),0)),this.totalQueued=I(()=>this.currentModels().reduce((e,r)=>e+(r.queued??0),0)),this.totalQueuedUnit=I(()=>{let e=this.totalQueued();return this.activeTab()==="image"?this.unitConversion.formatModelQueuedImage(e):this.unitConversion.formatModelQueuedText(e)}),H(()=>{this.loadModels()})}ngOnInit(){j([this.translator.get("details.models.title"),this.translator.get("app_title")]).pipe(D(this.destroyRef)).subscribe(([e,r])=>{this.title.setTitle(`${e} | ${r}`)})}setActiveTab(e){this.activeTab()!==e&&(this.activeTab.set(e),this.searchQuery.set(""),e==="image"&&this.imageModels().length===0?this.loadModels():e==="text"&&this.textModels().length===0&&this.loadModels())}loadModels(){let e=this.activeTab();this.loading.set(!0),this.error.set(null),(e==="image"?this.aiHorde.getImageModels():this.aiHorde.getTextModels()).pipe(D(this.destroyRef),q(()=>this.loading.set(!1))).subscribe({next:d=>{e==="image"?this.imageModels.set(d):this.textModels.set(d)},error:d=>{this.error.set(d.message||(e==="image"?"Failed to load image models":"Failed to load text models"))}})}onSearchChange(e){let r=e.target;this.searchQuery.set(r.value)}setSortField(e){this.sortField()===e?this.sortDirection.set(this.sortDirection()==="asc"?"desc":"asc"):(this.sortField.set(e),this.sortDirection.set("desc"))}formatEta(e){return!e||e<=0?"-":e<60?`${Math.round(e)}s`:e<3600?`${Math.round(e/60)}m`:`${Math.round(e/3600)}h`}formatNumber(e){return e==null?"-":e.toLocaleString()}};s.\u0275fac=function(r){return new(r||s)},s.\u0275cmp=U({type:s,selectors:[["app-models-list"]],decls:22,vars:20,consts:[[1,"stack-lg"],[1,"details-tabs"],["type","button",1,"details-tab",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24","aria-hidden","true",1,"icon-sm"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M7.5 8.25h9m-9 3H12m-9.75 1.51c0 1.6 1.123 2.994 2.707 3.227 1.129.166 2.27.293 3.423.379.35.026.67.21.865.501L12 21l2.755-4.133a1.14 1.14 0 0 1 .865-.501 48.172 48.172 0 0 0 3.423-.379c1.584-.233 2.707-1.626 2.707-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0 0 12 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018Z"],["type","button",1,"btn-source-control",3,"click","disabled"],["aria-hidden","true",1,"spinner","spinner-sm"],[1,"details-summary"],[1,"details-filters"],[1,"state-container","state-container-sm","state-error"],[1,"state-container","state-container-sm","text-secondary"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"],[1,"summary-stat"],[1,"summary-label"],[1,"summary-value"],[1,"text-secondary"],[3,"unit","swapDisplay"],[1,"filter-search"],["fill","none","stroke","currentColor","viewBox","0 0 24 24","aria-hidden","true",1,"icon-sm","filter-search-icon"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"],["type","text",1,"filter-input",3,"input","placeholder","value"],["fill","none","stroke","currentColor","viewBox","0 0 24 24","aria-hidden","true",1,"state-icon"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 9v3.75m9-.75a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 3.75h.008v.008H12v-.008Z"],["type","button",1,"btn-source-control",3,"click"],[1,"spinner","spinner-md"],[1,"state-container","state-container-sm","state-muted"],[1,"models-table"],["fill","none","stroke","currentColor","viewBox","0 0 24 24","aria-hidden","true",1,"state-icon-lg"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","1.5","d","M9.75 3.104v5.714a2.25 2.25 0 0 1-.659 1.591L5 14.5M9.75 3.104c-.251.023-.501.05-.75.082m.75-.082a24.301 24.301 0 0 1 4.5 0m0 0v5.714c0 .597.237 1.17.659 1.591L19.8 15.3M14.25 3.104c.251.023.501.05.75.082M19.8 15.3l-1.57.393A9.065 9.065 0 0 1 12 15a9.065 9.065 0 0 1-6.23.693L5 15.3m14.8 0 .002.004A4.5 4.5 0 0 1 17.25 21h-10.5a4.5 4.5 0 0 1-2.553-5.696l.002-.004"],[1,"models-table-header"],["type","button",1,"models-table-th","models-table-th-sortable",3,"click"],[1,"sort-indicator"],["type","button",1,"models-table-th","models-table-th-right","models-table-th-sortable",3,"click"],[1,"models-table-row"],[1,"models-table-cell-name"],[1,"models-table-name",3,"title"],[1,"models-table-cell"],[1,"models-table-label"],[1,"models-table-value"],[3,"unit","primaryOverride"]],template:function(r,d){r&1&&(o(0,"div",0)(1,"div",1)(2,"button",2),h("click",function(){return d.setActiveTab("image")}),k(),o(3,"svg",3),f(4,"path",4),a(),l(5),m(6,"transloco"),a(),w(),o(7,"button",2),h("click",function(){return d.setActiveTab("text")}),k(),o(8,"svg",3),f(9,"path",5),a(),l(10),m(11,"transloco"),a(),w(),o(12,"button",6),h("click",function(){return d.loadModels()}),_(13,K,1,0,"div",7)(14,X,2,0,":svg:svg",3),l(15),m(16,"transloco"),a()(),_(17,Y,17,10,"div",8),_(18,ee,6,4,"div",9),_(19,te,8,4,"div",10),_(20,ie,5,3,"div",11),_(21,fe,2,1),a()),r&2&&(t(2),C("details-tab-active",d.activeTab()==="image"),t(3),x(" ",p(6,14,"details.models.tabs.image")," "),t(2),C("details-tab-active",d.activeTab()==="text"),t(3),x(" ",p(11,16,"details.models.tabs.text")," "),t(2),y("disabled",d.loading()),t(),v(d.loading()?13:14),t(2),x(" ",p(16,18,"details.models.refresh")," "),t(2),v(!d.loading()&&!d.error()&&d.currentModels().length>0?17:-1),t(),v(!d.loading()&&!d.error()&&d.currentModels().length>0?18:-1),t(),v(d.error()?19:-1),t(),v(d.loading()&&!d.error()?20:-1),t(),v(!d.loading()&&!d.error()?21:-1))},dependencies:[R,Z,O],encapsulation:2,changeDetection:0});let i=s;return i})();export{Be as ModelsListComponent};
